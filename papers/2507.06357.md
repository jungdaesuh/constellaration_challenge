## **Differentiable Stellar Atmospheres with Physics-Informed Neural Networks**

**Jiadong Li*** [1] **Mingjie Jian*** [2] **Yuan-Sen Ting*** [3 4] **Gregory M. Green** [1]



**Abstract**


We present _Kurucz-a1_, a physics-informed neural network (PINN) that emulates 1D stellar atmosphere models under Local Thermodynamic
Equilibrium (LTE), addressing a critical bottleneck in differentiable stellar spectroscopy. By
incorporating hydrostatic equilibrium as a physical constraint during training, _Kurucz-a1_ creates
a differentiable atmospheric structure solver that
maintains physical consistency while achieving
computational efficiency. _Kurucz-a1_ can achieve
superior hydrostatic equilibrium and more consistent with the solar observed spectra compared
to ATLAS-12 itself, demonstrating the advantages of modern optimization techniques. Combined with modern differentiable radiative trans
fer codes, this approach enables data-driven optimization of universal physical parameters across
diverse stellar populations—a capability essential
for next-generation stellar astrophysics.


**1. Introduction**


Understanding stellar properties requires detailed modeling of observed spectra using stellar atmosphere models.
Since stellar interiors are opaque to radiation, observable absorption features originate primarily from the photosphere
(Gray, 2008), the layer where light begins to escape from
the atmosphere.


Stellar spectral modeling typically involves two central
steps: constructing an atmospheric model and generating
synthetic spectra. The first step determines the atmospheric
structure—temperature, pressure, and electron density as
functions of optical depth (measured in Rosseland mean


  - Equal contribution 1 Max-Planck-Institut fur Astronomie, Hei- ¨
delberg, Germany [2] Department of Astronomy, Stockholm University, Sweden [3] Department of Astronomy, The Ohio State University, USA [4] Center for Cosmology and AstroParticle Physics,
The Ohio State University, USA. Correspondence to: Jiadong Li
_<_ jdli@mpia.de _>_ .


_Proceedings of the_ _42_ _[nd]_ _International Conference on Machine_
_Learning_, Vancouver, Canada. PMLR 267, 2025. Copyright 2025
by the author(s).



opacity units)—by iteratively solving radiative transfer, radiative and hydrostatic equilibrium equations under assumptions of one-dimensional stratification and local thermodynamic equilibrium (LTE) (Hubeny & Mihalas, 2015).
Traditional approaches rely on pre-computed grids such
as ATLAS (Castelli & Kurucz, 2003), MARCS (Gustafsson
et al., 2008), and PHOENIX (Allard, 2016). The second
step uses this fixed atmospheric structure for spectral synthesis (e.g. Kurucz & Avrett, 1981; Sneden et al., 2012;
Gerber et al., 2023; Piskunov & Valenti, 2017), performing
radiative transfer calculations to generate synthetic spectra.


However, the output spectra are influenced by numerous
poorly constrained parameters. Atomic transition parameters, such as oscillator strengths for individual lines, often require laboratory measurements or theoretical calculations that may be inaccurate (Asplund, 2005; Laverick et al.,
2018). Furthermore, atmospheric modeling relies on opacity calculations (Magic et al., 2013; Colgan et al., 2016),
convection treatments (Asplund et al., 2000a;b; Neilson &
Lester, 2013; Pasetto et al., 2014), and assumptions about atmospheric structure (Asplund et al., 2005), which introduce
systematic uncertainties into spectral modeling.


Large-scale spectroscopic surveys such as the Sloan Digital
Sky Survey (York, 2000) and LAMOST (Zhao et al., 2012)
provide extensive datasets that could enable optimization of
these model parameters. While individual stars have different fundamental properties (effective temperature, surface
gravity, metallicity), the underlying atomic physics remains
universal. In principle, a differentiable end-to-end modeling
framework could optimize these universal parameters by
fitting large stellar samples while marginalizing over starby-star properties—effectively using the diversity of stellar
observations to constrain the physics that governs all stars.


Ideally, creating differentiable stellar spectroscopy codes
would involve rewriting existing models in modern frameworks like PyTorch or JAX . However, most stellar atmosphere codes predate the widespread adoption of automatic
differentiation. Many of these codes (e.g. Castelli & Kurucz,
2003) are written in legacy languages, such as Fortran
77, and have limited documentation. This presents a barrier
to modernization, even with current automated coding tools.


Fortunately, the two modeling components—atmospheric
structure model and radiative transfer—can be addressed



1


**Differentiable Stellar Atmospheres**


rucz, 1970; Kurucz & Avrett, 1981; Kurucz, 1996; 2014)
—cornerstone tools in stellar astrophysics developed by
Robert Kurucz [1] . The ATLAS-12 atmospheric structure
solver produces high-dimensional vector fields as functions
of Rosseland optical depth: six atmospheric parameters
(temperature, pressure, density, electron number density,
opacity, and radiative acceleration) across 80 depth points,
yielding 480-dimensional outputs.


The input space is equally complex. While fundamental
stellar parameters ( _T_ eff, log _g_, [Fe/H], [ _α_ /Fe]) provide the
primary constraints, individual elemental abundances can affect atmospheric structure (LeBlanc et al., 2009; Ting et al.,
2016). This creates a challenging high-dimensional inputoutput mapping problem where traditional neural network
architectures lack appropriate inductive biases for the complex physical relationships governing stellar atmospheres.


However, stellar atmospheric structure is governed by wellestablished physical laws—primarily hydrostatic equilibrium and radiative transfer equations. These constraints
provide the essential inductive bias that standard architectures cannot capture. Physics-Informed Neural Networks
(PINNs) (E & Yu, 2017; Raissi et al., 2018; 2019) offer an
optimal solution by integrating these physical constraints
directly into the learning process through composite loss
functions that enforce both data fidelity and physics compli
ance.


**3. Method**



_Figure 1._ _Kurucz-a1_ neural network architecture with dualencoder design. Stellar parameters ( _T_ eff, log _g_, [Fe/H], [ _α_ /Fe])
and optical depth points are encoded separately, then concatenated
and processed through fully connected layers (FC) to predict atmospheric parameters ( _ρ_ _x_, _T_, _P_, _κ_, _X_ NE, ACCRAD) at each depth
point.


separately. Modern frameworks such as Korg (Wheeler
et al., 2024) have successfully modernized radiative transfer solvers in differentiable languages. However, the atmospheric structure solver remains the key bottleneck for
end-to-end differentiable modeling.


In this study, we address this bottleneck by developing a
physics-informed neural network (PINN) emulator for stellar atmospheric structure calculations. While this approach
does not directly solve the differential equations in a differentiable framework, it creates a differentiable component
that, when combined with modern radiative transfer solvers,
enables the end-to-end optimization framework described
above.


**2. Motivation for PINN**


Emulating stellar atmospheric structure presents challenges
even in discretized form. Consider the ATLAS codes (Ku


_Kurucz-a1_ employs a dual-encoder architecture (Figure 1)
that separates global stellar parameters from local depth
information. This design reflects the underlying physics
where global stellar properties establish the overall atmospheric structure, while local conditions vary systematically
with atmospheric depth.


The stellar parameter encoder processes four fundamental quantities—effective temperature ( _T_ eff ), surface
gravity ( log _g_ ), metallicity ([Fe/H]), and _α_ -enhancement
([ _α_ /Fe])—through a multi-layer perceptron to produce 512dimensional embeddings. The depth encoder transforms
the 80 Rosseland optical depth points ( _τ_ Ross ) into 512dimensional representations at each atmospheric layer, allowing the network to learn appropriate representations for
the atmospheric depth coordinate.


The stellar parameter embedding is broadcast and concatenated with each depth embedding to form 1024-dimensional
combined embeddings at all 80 depth points. These are


1 Robert Kurucz, who dedicated his life to developing these
transformative codes, passed away in 2025. Together with Fiorella
Castelli, they built the foundation on which much of contemporary
stellar spectroscopy still relies. This work aims to preserve and
further modernize their shared legacy.



2


**Differentiable Stellar Atmospheres**
















|T|2|
|---|---|
||1<br>1<br>|
|||
|||
|||

|P|2|
|---|---|
||1<br>1<br>|
|||
|||
|||












_Figure 2._ Relative error distributions for atmospheric parameters predicted by _Kurucz-a1_ compared to ATLAS-12 models. The four panels
show column mass density (RHOX), temperature (T), pressure (P), and Rosseland opacity (ABROSS) versus optical depth. The validation
dataset spans Galactic stellar populations (see appendix).







|ATLAS-12 (Ground Truth)|Col2|
|---|---|
|ATLAS-12 (Ground Truth)<br>Kurucz-a1 (Predicted)<br>MLP baseline (Predicted)|ATLAS-12 (Ground Truth)<br>Kurucz-a1 (Predicted)<br>MLP baseline (Predicted)|
|||
|~~102~~<br>~~104~~<br>Gravity / Opacity|~~106~~<br> (g/ )|


_Figure 3._ Hydrostatic equilibrium diagnostic for a representative
red-giant branch star ( _T_ eff = 4500 K, log _g_ = 2 _._ 5, [Fe _/_ H] = 0,

[ _α_ /Fe] = 0). Deviations from the diagonal indicate violations
of _dP/dτ_ = _g/κ_ . _Kurucz-a1_ (dashed) demonstrates superior
agreement compared to the MLP baseline (dot-dashed), nearly
matching ATLAS-12 (solid).


processed through a 3-layer MLP emulator (with hidden
dimensions [1024, 512, 256]) to predict six atmospheric
parameters at each depth: column mass density ( _ρ_ _x_ ), temperature ( _T_ ), gas pressure ( _P_ ), electron number density
( _X_ NE ), Rosseland mean opacity ( _κ_ Ross ), and radiative acceleration (ACCRAD). We use GeLU activations (Hendrycks
& Gimpel, 2016).


The total loss function combines data reproduction and



where _[dP]_ _dτ_ [is computed via automatic differentiation, enforc-]







_Figure 4._ Distribution of hydrostatic equilibrium loss values across
the validation dataset. _Kurucz-a1_ (purple) achieves a tight distribution comparable to ATLAS-12 (gray), while the MLP baseline
(red) shows higher and more scattered values. Values near zero indicate perfect adherence to the hydrostatic equilibrium constraint.


physics enforcement:


_L_ total = (1 _−_ _α_ ) _· L_ data + _α · L_ physics (1)


with _α_ = 0 _._ 03 by grid search, where _L_ data is the MSE loss of
the predicted outputs. The physics loss enforces hydrostatic
equilibrium:



1
_L_ physics =
_N_ _b_ _· N_ _d_



�

_i,j_



_dP_
� _dτ_



_dτ_ _[−]_ _κ_ _[g]_



_κ_



2


(2)

� _i,j_



3


**Differentiable Stellar Atmospheres**



ing the constraint that governs atmospheric stability:



_dP_



(3)
_κ_




_[g]_
_dτ_ [=] _κ_



_a1_ closely match both ATLAS-12 models and observations
from the Melchior database (Royer, 2024), confirming that
the emulated atmospheric output is indistinguishable from
reference models. _Kurucz-a1_ even outperforms ATLAS-12
in some spectral line wings, likely due to better hydrostatic
equilibrium adherence.


**5. Broader Impact**


_Kurucz-a1_, available open-source at [https://github.](https://github.com/jiadonglee/kurucz-a1)
[com/jiadonglee/kurucz-a1](https://github.com/jiadonglee/kurucz-a1), provides a practical
tool and methodological template for the astronomical
community, achieving a mean inference time of 0 _._ 37 _±_
0 _._ 06 millisecond per model on an Apple M1 Pro chip.


For stars hotter than _∼_ 4500K, where molecular transitions are minimal, radiative transfer codes typically execute
within seconds to minutes. Consequently, stellar spectral
analysis commonly employs sparse grids of pre-computed
atmospheric models, running only spectral synthesis code
like Korg (Wheeler et al., 2024) and PySME (Piskunov &
Valenti, 2017; Wehrhahn et al., 2023) to synthesize lines for
comparison with observations.


However, as demonstrated by Ting et al. (2016), these sparse
atmospheric grids introduce systematic errors in stellar line
analysis. While solving stellar atmospheric structure with
codes like ATLAS requires computational overhead (minutes to hours per model), current sparse grid approaches
also limit analysis to few parameters, grouping elemental
abundances into broad categories like [Fe/H] and [ _α_ /Fe].


_Kurucz-a1_ provides a low-cost replacement for stellar atmosphere synthesis models. It generates atmospheric output
within seconds, making it practical to eliminate the interpolation errors inherent in sparse grids while maintaining
computational efficiency. This framework also eases data
storage and transfer requirements when additional abundance dimensions are included.


The current implementation uses four stellar parameters
consistent with existing atmospheric grids. Future work will
extend the PINN framework to higher-dimensional parameter spaces, enabling incorporation of additional abundance
dimensions (alpha-elements, CNO, helium) essential for
modeling diverse stellar populations, as well as incorporating additional physics such as equation of state and energy
balance.


Beyond practical applications, this work addresses a fundamental bottleneck in achieving end-to-end differentiable
stellar spectroscopy. Combined with modern differentiable
radiative transfer codes, this approach opens pathways to
data-driven calibration of atomic physics parameters that
current stellar models must assume.



**4. Results**


We evaluate _Kurucz-a1_ ’s performance to demonstrate that
physics-informed constraints are essential for robust stellar
atmosphere emulation. The validation encompasses 10,427
stellar models spanning _T_ eff = 2500 –50,000 K, log _g_ = _−_ 1 –
5.5, [Fe/H] = _−_ 4 – +1 _._ 46, and [ _α_ /Fe] = _−_ 0 _._ 2 – +0 _._ 62 (see
Appendix for training data details).


Figure 2 shows the relative error distributions across optical
depth for all atmospheric parameters. _Kurucz-a1_ achieves
median errors below 0.12% for temperature, 1.1% for pressure and density, and 1.5% for opacity across the full range
of stellar parameters tested. These errors are well within
acceptable bounds for stellar atmosphere modeling. For
context, even state-of-the-art grids like MARCS and ATLAS exhibit temperature differences of 10 K to 80 K in
their upper layers ( _τ_ Ross _≤_ 10 _[−]_ [2] ), which is considered the
current frontier of uncertainty stemming from different input physics (Gustafsson et al., 2008). Comparisons for the
APOGEE survey show the MARCS and ATLAS9 grids
agree to within _<_ 1% for temperature (Heiter et al., 2015)
and 2-3% for pressure (Mesz ´ aros et al. ´, 2012). Since our
model’s median temperature error is well below these accepted inter-model discrepancies, it demonstrates a high
degree of fidelity.


However, accurate stellar atmosphere modeling requires
more than point-wise precision—the physical consistency
of atmospheric profiles is crucial (Magic et al., 2013). Radiative transfer calculations depend critically on pressure
and temperature gradients, not just their absolute values
(Hayek et al., 2010).


Figure 3 demonstrates the advantage of _Kurucz-a1_ in maintaining hydrostatic equilibrium. _Kurucz-a1_ achieves hydrostatic equilibrium comparable to ATLAS-12 itself, while
outperforming the MLP baseline that lacks physics constraints. This validates the vital role of physics-informed
loss terms.


Notably, _Kurucz-a1_, on average, achieves even better hydrostatic equilibrium than ATLAS-12, likely due to ATLAS12’s discrete numerical scheme and optimization methods
that predate modern gradient-based techniques. The small
deviations from precise equilibrium in ATLAS-12 ( _∼_ 0.1%
level) reflect limitations of finite-difference discretization.


Finally, we validated _Kurucz-a1_ ’s practical utility by synthesizing solar spectra using PySME (Wehrhahn et al., 2023;
Piskunov & Valenti, 2017) and comparing with observations
(Figure 5). The synthetic spectra generated using _Kurucz-_



4


**Differentiable Stellar Atmospheres**


_Figure 5._ Solar spectrum synthesis validation. **Top** : Observed solar spectrum (green dashed) compared to synthetic spectra from
_Kurucz-a1_ (blue) and ATLAS-12 (orange). **Middle** : Direct comparison between _Kurucz-a1_ and ATLAS-12 synthetic spectra, showing
minimal differences. **Bottom** : Residuals relative to observed spectrum demonstrate that _Kurucz-a1_ achieves better agreement than
ATLAS-12 due to superior hydrostatic equilibrium adherence.



**6. Acknowledgements**


We thank the anonymous referee for their constructive suggestions. JL thanks Chao Liu and Hans-Walter Rix for their
insightful discussions. JL acknowledges support from the
European Research Council through ERC Advanced Grant
No. 101054731. Computations were performed on the
HPC system Raven at the Max Planck Computing and Data
Facility.


**References**


Allard, F. The PHOENIX Model Atmosphere Grid for
Stars. In Reyle, C., Richard, J., Cambr ´ esy, L., Deleuil, ´
M., Pecontal, E., Tresse, L., and Vauglin, I. (eds.), ´ _SF2A-_
_2016: Proceedings of the Annual meeting of the French_
_Society of Astronomy and Astrophysics_, pp. 223–227, December 2016.


Asplund, M. Uncertainties in stellar abundance analyses.
_Highlights of Astronomy_, 13:542–547, 2005. doi: 10.
1017/S1539299600016555.


Asplund, M., Nordlund, A., Trampedach, R., Allende Prieto, [˚]
C., and Stein, R. F. Line formation in solar granulation. I.
Fe line shapes, shifts and asymmetries. _A&A_, 359:729–
742, July 2000a. doi: 10.48550/arXiv.astro-ph/0005320.



Asplund, M., Nordlund, A., Trampedach, R., and Stein, R. F. [˚]
Line formation in solar granulation. II. The photospheric
Fe abundance. _A&A_, 359:743–754, July 2000b. doi:
10.48550/arXiv.astro-ph/0005321.


Asplund, M., Grevesse, N., and Sauval, A. J. The Solar
Chemical Composition. In Barnes, III, T. G. and Bash,
F. N. (eds.), _Cosmic Abundances as Records of Stellar_
_Evolution and Nucleosynthesis_, volume 336 of _Astronom-_
_ical Society of the Pacific Conference Series_, pp. 25,
September 2005.


Bressan, A., Marigo, P., Girardi, L., Salasnich, B., Dal Cero,
C., Rubele, S., and Nanni, A. PARSEC: stellar tracks and

isochrones with the PAdova and TRieste Stellar Evolution

Code. _MNRAS_, 427(1):127–145, November 2012. doi:
10.1111/j.1365-2966.2012.21948.x.


Castelli, F. and Kurucz, R. L. New Grids of ATLAS9 Model
Atmospheres. In Piskunov, N., Weiss, W. W., and Gray,
D. F. (eds.), _Modelling of Stellar Atmospheres_, volume
210 of _IAU Symposium_, pp. A20, January 2003. doi:
10.48550/arXiv.astro-ph/0405087.


Colgan, J., Kilcrease, D. P., Magee, N. H., Sherrill, M. E.,
Abdallah, Jr., J., Hakel, P., Fontes, C. J., Guzik, J. A.,
and Mussack, K. A. A New Generation of Los Alamos



5


**Differentiable Stellar Atmospheres**



Opacity Tables. _ApJ_, 817(2):116, February 2016. doi:
10.3847/0004-637X/817/2/116.


E, W. and Yu, B. The Deep Ritz method: A deep learningbased numerical algorithm for solving variational problems. _arXiv e-prints_, art. arXiv:1710.00211, September
2017. doi: 10.48550/arXiv.1710.00211.


Gerber, J. M., Magg, E., Plez, B., Bergemann, M., Heiter,
U., Olander, T., and Hoppe, R. Non-LTE radiative transfer
with Turbospectrum. _A&A_, 669:A43, January 2023. doi:
10.1051/0004-6361/202243673.


Gray, D. F. _The Observation and Analysis of Stellar Photo-_
_spheres_ . 2008.


Gustafsson, B., Edvardsson, B., Eriksson, K., Jørgensen,
U. G., Nordlund, A., and Plez, B. A grid of MARCS [˚]
model atmospheres for late-type stars. I. Methods and
general properties. _A&A_, 486(3):951–970, August 2008.
doi: 10.1051/0004-6361:200809724.


Hayek, W., Asplund, M., Carlsson, M., Trampedach, R.,
Collet, R., Gudiksen, B. V., Hansteen, V. H., and
Leenaarts, J. Radiative transfer with scattering for
domain-decomposed 3D MHD simulations of cool stellar atmospheres. Numerical methods and application to
the quiet, non-magnetic, surface of a solar-type star.
_A&A_, 517:A49, July 2010. doi: 10.1051/0004-6361/
201014210.


Heiter, U., Jofre, P., Gustafsson, B., Korn, A. J., Soubiran, ´
C., and Thevenin, F. Gaia FGK benchmark stars: Effec- ´
tive temperatures and surface gravities. _A&A_, 582:A49,
October 2015. doi: 10.1051/0004-6361/201526319.


Hendrycks, D. and Gimpel, K. Gaussian Error Linear Units
(GELUs). _arXiv e-prints_, art. arXiv:1606.08415, June
2016. doi: 10.48550/arXiv.1606.08415.


Hubeny, I. and Mihalas, D. _Theory of Stellar Atmospheres._
_An Introduction to Astrophysical Non-equilibrium Quan-_
_titative Spectroscopic Analysis_ . 2015.


Kurucz, R. L. Atlas: a Computer Program for Calculating
Model Stellar Atmospheres. _SAO Special Report_, 309,
February 1970.


Kurucz, R. L. Status of the ATLAS 12 Opacity Sampling
Program and of New Programs for Rosseland and for
Distribution Function Opacity. In Adelman, S. J., Kupka,
F., and Weiss, W. W. (eds.), _M.A.S.S., Model Atmospheres_
_and Spectrum Synthesis_, volume 108 of _Astronomical_
_Society of the Pacific Conference Series_, pp. 160, January
1996.


Kurucz, R. L. ATLAS12: Opacity sampling model atmosphere program. Astrophysics Source Code Library,
record ascl:1303.024, March 2013.



Kurucz, R. L. Model Atmosphere Codes: ATLAS12 and
ATLAS9. In Niemczura, E., Smalley, B., and Pych, W.
(eds.), _Determination of Atmospheric Parameters of B_,
pp. 39–51. 2014. doi: 10.1007/978-3-319-06956-2 ~~4~~ .


Kurucz, R. L. and Avrett, E. H. Solar Spectrum Synthesis. I.
A Sample Atlas from 224 to 300 nm. _SAO Special Report_,
391, May 1981.


Laverick, M., Lobel, A., Merle, T., Royer, P., Martayan,
C., David, M., Hensberge, H., and Thienpont, E. The
Belgian repository of fundamental atomic data and stellar
spectra (BRASS). I. Cross-matching atomic databases of
astrophysical interest. _A&A_, 612:A60, April 2018. doi:
10.1051/0004-6361/201731933.


LeBlanc, F., Monin, D., Hui-Bon-Hoa, A., and Hauschildt,
P. H. Stellar model atmospheres with abundance stratification. _A&A_, 495(3):937–944, March 2009. doi:
10.1051/0004-6361:200810848.


Magic, Z., Collet, R., Asplund, M., Trampedach, R., Hayek,
W., Chiavassa, A., Stein, R. F., and Nordlund, A. The [˚]
Stagger-grid: A grid of 3D stellar atmosphere models. I.
Methods and general properties. _A&A_, 557:A26, September 2013. doi: 10.1051/0004-6361/201321274.


Mesz ´ aros, S., Allende Prieto, C., Edvardsson, B., Castelli, ´
F., Garc ´ ıa Perez, A. E., Gustafsson, B., Majewski, S. R., ´
Plez, B., Schiavon, R., Shetrone, M., and de Vicente, A.
New ATLAS9 and MARCS Model Atmosphere Grids
for the Apache Point Observatory Galactic Evolution
Experiment (APOGEE). _AJ_, 144(4):120, October 2012.
doi: 10.1088/0004-6256/144/4/120.


Neilson, H. R. and Lester, J. B. Spherically symmetric
model stellar atmospheres and limb darkening. II. Limbdarkening laws, gravity-darkening coefficients and angular diameter corrections for FGK dwarf stars. _A&A_, 556:
A86, August 2013. doi: 10.1051/0004-6361/201321888.


Pasetto, S., Chiosi, C., Cropper, M., and Grebel, E. K. Theory of stellar convection: removing the mixing-length
parameter. _MNRAS_, 445(4):3592–3609, December 2014.
doi: 10.1093/mnras/stu1933.


Piskunov, N. and Valenti, J. A. Spectroscopy Made Easy:
Evolution. _A&A_, 597:A16, January 2017. doi: 10.1051/
0004-6361/201629124.


Raissi, M., Yazdani, A., and Karniadakis, G. E. Hidden
Fluid Mechanics: A Navier-Stokes Informed Deep Learning Framework for Assimilating Flow Visualization Data.
_arXiv e-prints_, art. arXiv:1808.04327, August 2018. doi:
10.48550/arXiv.1808.04327.



6


**Differentiable Stellar Atmospheres**


Raissi, M., Perdikaris, P., and Karniadakis, G. E. Physicsinformed neural networks: A deep learning framework for
solving forward and inverse problems involving nonlinear
partial differential equations. _Journal of Computational_
_Physics_, 378:686–707, February 2019. doi: 10.1016/j.jcp.
2018.10.045.


Royer, P., e. a. MELCHIORS. The Mercator Library of
High Resolution Stellar Spectroscopy. _A&A_, 681:A107,
January 2024. doi: 10.1051/0004-6361/202346847.


Sneden, C., Bean, J., Ivans, I., Lucatello, S., and Sobeck,
J. MOOG: LTE line analysis and spectrum synthesis.
Astrophysics Source Code Library, record ascl:1202.009,
February 2012.


Ting, Y.-S., Conroy, C., and Rix, H.-W. Accelerated Fitting
of Stellar Spectra. _ApJ_, 826(1):83, July 2016. doi: 10.
3847/0004-637X/826/1/83.


Wehrhahn, A., Piskunov, N., and Ryabchikova, T. PySME.
Spectroscopy Made Easier. _A&A_, 671:A171, March 2023.
doi: 10.1051/0004-6361/202244482.


Wheeler, A. J., Casey, A. R., and Abruzzo, M. W. Korg:
Fitting, Model Atmosphere Interpolation, and Brackett
Lines. _AJ_, 167(2):83, February 2024. doi: 10.3847/
1538-3881/ad19cc.


York, D. G., e. a. The Sloan Digital Sky Survey: Technical
Summary. _AJ_, 120:1579–1587, September 2000. doi:
10.1086/301513. URL [http://adsabs.harvard.](http://adsabs.harvard.edu/abs/2000AJ....120.1579Y)
[edu/abs/2000AJ....120.1579Y.](http://adsabs.harvard.edu/abs/2000AJ....120.1579Y)


Zhao, G., Zhao, Y.-H., Chu, Y.-Q., Jing, Y.-P., and Deng,
L.-C. LAMOST spectral survey — An overview. _Re-_
_search in Astronomy and Astrophysics_, 12(7):723–734,
July 2012. doi: 10.1088/1674-4527/12/7/002.


7


**Differentiable Stellar Atmospheres**


_Figure 6._ Distribution of stellar atmospheric models in the training dataset. _Left panel:_ Kiel diagram showing coverage in effective
temperature ( log _T_ eff ) versus surface gravity ( log _g_ ) parameter space. The colored evolutionary tracks from PARSEC models (Bressan
et al., 2012) represent different stellar ages (0.1, 1, 10 Gyr) and metallicities (-1 and 0). _Right panel:_ Distribution in the [Fe/H]–[ _α_ /Fe]
abundance plane, showing the density of atmospheric models with contour lines indicating regions of highest concentration.


**A. Appendix: Training Data**


Our model utilizes pre-computed stellar atmosphere grids from the ATLAS-12 code (Kurucz, 2013), as illustrated in Figure 6.
The grid encompasses effective temperatures ( _T_ eff ) spanning 2500–50,000 K, surface gravities ( log _g_ ) from _−_ 1 to 5 _._ 5,
metallicities ([Fe/H]) from _−_ 4 to +1 _._ 46, and _α_ -element abundances ([ _α_ /Fe]) from _−_ 0 _._ 2 to +0 _._ 62.


The dataset comprises 104,269 atmospheric models, each providing six fundamental parameters as functions of 80 optical
depth points: column mass density ( _ρ_ _x_ ), temperature ( _T_ ), gas pressure ( _P_ ), electron number density ( _X_ NE ), Rosseland mean
opacity ( _κ_ Ross ), and radiative acceleration (ACCRAD).


To optimize sampling for Galactic stellar studies, we implemented enhanced density for red giant branch (RGB) stars in
both the Kiel diagram and [Fe/H]–[ _α_ /Fe] plane, given their importance for understanding Galactic dynamics and chemical
evolution. The enhanced sampling around metallicity ([Fe/H] _∼−_ 1 to +0 _._ 5 ) and _α_ -abundance patterns ([ _α_ /Fe] _∼_ 0 _._ 0 – 0 _._ 4 )
reflects the focus on Galactic stellar populations.


The dataset was randomly partitioned into training (90%, 93,842 models) and validation (10%, 10,427 models) subsets for
model development and performance evaluation.


8


