**Augmented Lagrangian methods produce cutting-edge**
**magnetic coils for stellarator fusion reactors**


Pedro F. Gil, [1] Alan A. Kaptanoglu, [2] and Eve V. Stenson [1]

1 _Max-Planck-Institut f¨ur Plasmaphysik, 85748 Garching, Germany_
2 _Courant Institute of Mathematical Sciences, New York University,_
_New York, NY 10012, United States of America_
(Dated: July 18, 2025)


Finding feasible coils for stellarator fusion devices is a crux of realizing this concept for future
power plants. The coils must reproduce the physics properties of the target plasma while satisfying myriad engineering constraints. Current efforts struggle to navigate the highly nonconvex
optimization landscape and result in suboptimal stellarator coils, and/or they end up spending
considerable resources scanning the continuous parameter space. In this work, we present an augmented Lagrangian approach to tackle the ill-posed problem of coil optimization. Our approach
yields solutions that out-perform previous Pareto-optimal work and display excellent physics and
engineering properties. We conclude by illustrating its effectiveness and versatility by generating
coils for five stellarators with very different symmetries and magnetic field shaping. In all cases, we
find coil solutions that in various ways outperform published coil sets, including built and operating
reactors such as Wendelstein 7-X (W7-X) and the Helically Symmetric eXperiment (HSX).



**I.** **INTRODUCTION**


The stellarator, a toroidal magnetic confinement device, stands as a promising candidate for achieving controlled nuclear fusion. Unlike its axisymmetric counterpart, the tokamak, the stellarator relies on complex,
three-dimensional magnetic fields to confine the plasma
and therefore does not require the use of induced currents
that can lead to plasma instabilities [1–3]. This also allows for steady-state operation, which provides a clear
advantage over other technologies to become an energy
source. The confining magnetic fields are generated by a
system of external coils, the design of which is a critical
determinant of the stellarator’s performance and viability. Mathematically, the coils are arbitrary 3D curves
in space, and poor optimization of these can easily produce infeasible shapes. Traditionally, stellarator design
is subdivided into two stages: stage I, where the plasma
boundary shape is optimized, and stage II, where the
coil shapes and currents are optimized. This procedure
has been used in essentially all previous stellarator designs, including for designing currently operational experiments such as Wendelstein 7-X and HSX [4–6]. This
two-stage process allows for stage-1 optimization to explore suitable physics properties for fusion reactors by
solving the magnetohydrodynamic equations of force balance in fixed-boundary [7–10]. A separate stage-II optimization allows one to focus the optimization on finding
feasible coil sets. The optimization of stellarator coils is
a magnetostatic ill-posed inverse problem; a multitude
of distinct coil configurations can, in principle, generate
similar magnetic fields, yet most of these solutions are
impractical from an engineering standpoint [11].


Ultimately, coil complexity and requirements for larger
build tolerances resulted in delays in the construction
and assembly of Wendelstein 7-X and the cancellation of
NCSX as it went 70 million dollars above its baseline cost



of 102 million dollars [12, 13]. It has been determined
that coil complexity and tolerances accounted for 66%
of the cost growth of NCSX. As for Wendelstein 7-X, it
took 10 years to build the reactor, suffering from several
delays due to lack of engineering capacity, strict margins
and tight coil tolerances [5]. Overall it took 10 [6] hours to
complete the 50 modular coils [14].
Historically, the stellarator community has explored
various approaches to tackle the challenge of finding simple yet accurate coils. These have ranged from employing stochastic optimization algorithms to prevent getting
stuck in local minima and providing robust configurations, performing large-scale scans capable of exploring
vast parameter spaces, investigating diverse coil topologies, such as modular, helical or dipole coils, and even optimizing the plasma and the coils simultaneously [15–24].
Despite these varied efforts, finding robust and efficient
coil optimization techniques remains a challenge. Currently, various stellarator equilibrium concepts are being investigated also in the industry [25–29]. Most of
these concepts take advantage of the various flavors of
omnigeneity, which is a magnetic field property allowing
for the confinement of collisionless trapped particles [30–
33]. This property applies to alpha particles that contain a considerable portion of the energy (3.5 MeV) produced from D-T fusion reactions, essential for plasma
heating. Among these flavors being pursued are the
quasi-axisymmetric (QA), quasi-helical symmetric (QH)
and quasi-isodynamic (QI) configurations [9, 34]. Even
with this restriction, there is remarkable freedom in the
plasma shape and plasma properties [35, 36]. This represents an additional challenge for the development of a
robust coil optimization scheme able to reliably deliver
stellarator coil sets independently of the complexity of
the magnetic configuration.
The engineering requirements for a fusion reactor include limitations on coil curvature, minimum separation
distances between coils, considerations for port access for


diagnostics, heating systems, and maintenance, and so
forth. These requirements must compete with the necessity of high field accuracy to reproduce the desired
plasma target. The engineering constraints are immense;
to see this, consider just the electromagnetic forces on
a reactor-scale stellarator design. Lion et al. [25] report
that for the Stellaris reactor-scale design, in order to keep
the mechanical integrity of the stellarator, steel plates
are placed between the coils. These can have thicknesses
“between 0.7 m and 1 m and could be forged, with the
heaviest plate in this design weighing 58 tons. The inner
rings [around the inner side of the stellarator], about 0.7
m thick and weighing about 200 tons each, can also be
forged”. It follows that a stellarator coil design that possesses even mildly reduced forces (e.g. 30%) could result
in a significantly more economically viable stellarator.
Furthermore, it is estimated that the original Stellaris
configuration will have anisotropic deformations in the
order of 15 mm, arising from electromagnetic loads. This
can potentially result in degraded field quality, asymmetries in the heat loads of island divertors, and so forth.
The immense force requirements in this example are not
unique to Stellaris, rather, they are emblematic of the
inevitable challenges of reactor-scale coil design for stellarators.

Finding coil configurations that simultaneously achieve
high magnetic field accuracy and adhere to these engineering requirements is a constrained and highly nonconvex optimization problem. Nonconvex constraints
are very challenging, so in practice this problem is converted into a multi-objective unconstrained optimization
problem with weights attached to each objective. These
weights are manually tuned to find coil solutions that
seem promising, but the values of these weights are hard
to choose because they have no physical significance. As
many as 10-15 weights are typically used to balance the
various engineering tradeoffs.


**A.** **Contributions of this work**


This manuscript implements an augmented Lagrangian method for coil optimization, aimed at tackling
this multifaceted challenge. We seek to identify best-todate stellarator coil designs in terms of the plasma and
engineering complexity metrics, while avoiding heuristic
and manual tuning of the optimization weights. We prove
the value of this new method by finding a substantial set
of coil solutions that, in various ways, outperform previously published coil sets. The entirety of this work is
implemented and can be reproduced in the SIMSOPT
optimization suite [37].


**II.** **OPTIMIZATION METHOD**


Early stellarator coil optimization methods considered a single continuous toroidal surface surrounding the



2


plasma, called a winding surface, where sheet currents
could flow and a current potential was well-defined. A solution for the current potential would be found, and then
coils would be “cut” from them. This approach has been
used to find the Wendelstein 7-X coils and can be found
in codes such as NESCOIL or REGCOIL [38, 39]. More
advanced winding surface methods are in development,
especially for generating good initial coils and for performing single-stage optimizations [20]. However, such
an approach constrains the coils to sit on a single predefined toroidal surface and therefore limits the exploration of better coil sets. Recent efforts have introduced
the concept of filamentary coils that can be described as
a truncated Fourier series, allowing for the adjustment of
the Fourier coefficients as the optimization is performed,
and avoiding any surface restriction. This is the representation used in this paper within the SIMSOPT software
framework, as described below in Cartesian coordinates
for the i-th coil,



where _c_ _l_ are the various inequality and equality constraints combined and _ω_ _l_ _∈_ R for _l_ = 1 _, ..., N_ _c_ are the
weights. Inequality constraints are typically recast to
equality constraints by _g_ _l_ _�→_ max( _g_ _l_ _−_ _g_ target _,_ 0), since
this quantity vanishes if _g_ _l_ ( _**x**_ ) is below the target value.



_M_
� _x_ _[i]_ _s,m_ [sin(] _[mθ]_ [)] _[,]_ (1)


_m_ =1



_x_ _[i]_ ( _θ_ ) =



_M_
� _x_ _[i]_ _c,m_ [cos(] _[mθ]_ [) +]


_m_ =0



and similarly for _y_ _[i]_ and _z_ _[i]_ . Here, _θ_ corresponds to
the coil arc length index, the order _M_ of the decomposition is to be defined by the user. The coefficients

[ _x_ _c,m_ _, x_ _s,m_ _, y_ _c,m_ _, y_ _s,m_ _, z_ _c,m_ _, z_ _s,m_ ], along with the currents
of the coils, constitute the _n_ = _N_ (3(2 _M_ + 1) + 1) degrees of freedom for _N_ coils of the optimization problem.
Coil optimization can be formulated as an equality and
inequality-constrained optimization problem:


minimize _f_ ( _**x**_ )
_**x**_



subject to _e_ _j_ ( _**x**_ ) = 0 _,_ _j ∈E_
_g_ _k_ ( _**x**_ ) _≤_ 0 _,_ _k ∈I_



(2)



Here _f_ : R _[n]_ _→_ R is the objective function to be minimized, _e_ _j_ : R _[n]_ _→_ R and _g_ _k_ : R _[n]_ _→_ R correspond to
equality and inequality constraints, _**x**_ _∈_ R _[n]_ are the degrees of freedom including the Fourier coefficients representing the coil filaments and currents, _E_ and _I_ are
the set of indices for equality constraints and inequality constraints, respectively. Consider _N_ _c_ constraints in
total. In previous work, the next step is to transform
this very challenging constrained optimization into an
unconstrained problem by constructing a weighted multiobjective function. This is the mechanism used in SIMSOPT, written in the form:



minimize _f_ ( _**x**_ ) +
_**x**_



_N_ _c_
� _ω_ _l_ _c_ _l_ ( _**x**_ ) _,_ (3)


_l_ =1


As was pointed out in Conlin et al. for plasma optimization [40], the weights _ω_ _l_ have to be set by the user,
rarely represent an optimal tradeoff, and therefore have
to be adjusted. It is also only possible to satisfy the
constraints when _ω_ _l_ _→∞_ . Moreover, in order to circumvent the struggle of weight adjustment, large-scale
scans of targets/weights are used, which can be computationally expensive and suffer restriction to local regions
of the parameter space. In order to tackle these issues,
the following augmented Lagrangian formulism for coil
optimization is proposed with the Lagrangian,


_L_ _A_ ( _**x**_ _,_ _**λ**_ _,_ _**µ**_ ) = _f_ ( _**x**_ ) _−_ _**λ**_ _[⊤]_ _**c**_ ( _**x**_ ) + [1] 2 _[∥√]_ ~~_**[µ]**_~~ _[ ◦]_ _**[c]**_ [(] _**[x]**_ [)] _[∥]_ 2 [2] _[,]_ (4)


where:


  - _**λ**_ _∈_ R _[N]_ _[c]_ is the vector of Lagrange multipliers.


  - _**µ**_ _∈_ R _[N]_ _[c]_ and _µ_ _l_ _>_ 0 for all _l_, are the penalty pa
rameters.


  - _**c**_ : R _[n]_ _→_ R _[N]_ _[c]_ is the vector of the original equality
constraints.


The term _**λ**_ _[⊤]_ _**c**_ ( _**x**_ ) is the standard Lagrange multiplier
term, and 2 [1] �� _√_ ~~_**µ**_~~ _◦_ _**c**_ ( _**x**_ )�� 2 is the penalty term defining

the Hadamard product between _**µ**_ and _**c**_ ( _**x**_ ). The latter
penalizes constraint violations. Note that what previously were user-determined hyperparameters become
now Lagrange multipliers that are meant to be updated
throughout the optimization, so time consuming manual updates are avoided. Moreover the penalty term
prevents the necessity of infinite magnitudes for the _ω_ _l_,
avoiding the two main disadvantages of the previous
formalisms. The algorithm employed to steer and update
the Lagrange multipliers is inspired from [40–42] and it
is here presented and adapted for clarity:


**Augmented Lagrangian Algorithm**


**Initialize** : _p_ = 0, _**x**_ 0, _**µ**_ 0 _>_ 0, _ω_ _tol_ _>_ 0, _η_ _tol_ _>_ 0, _τ >_ 1
_**λ**_ 0 _←_ array sampled from uniform distribution in [0,1]
_µ_ ¯ 0 _←_ Average( _**µ**_ 0 )
_ω_ 0 _←_ 1 _/µ_ ¯ 0
_η_ 0 _←_ 1 _/µ_ ¯ [0] 0 _[.]_ [1]
**While** _∥∇L_ _A_ ( _**x**_ _p_ _,_ _**λ**_ _p_ _,_ _**µ**_ _p_ ) _∥_ 2 _> ω_ _tol_ or _∥_ _**c**_ ( _**x**_ _p_ ) _∥_ _∞_ _> η_ _tol_
_**x**_ _p_ +1 _←_ argmin _**x**_ _L_ _A_ ( _**x**_ _,_ _**λ**_ _p_ _,_ _**µ**_ _p_ ), solved to tol. _ω_ _p_
**if** _∥_ _**c**_ ( _**x**_ _p_ +1 _,_ _**λ**_ _p_ _,_ _**µ**_ _p_ ) _∥_ _∞_ _< η_ _p_ then
_**λ**_ _p_ +1 _←_ _**λ**_ _p_ _−_ _**µ**_ _p_ _◦_ _**c**_ ( _**x**_ _p_ +1 )
_**µ**_ _p_ +1 _←_ _**µ**_ _p_
_ω_ _p_ +1 _←_ max( _ω_ _p_ _/µ_ ¯ _p_ +1 _, ω_ _tol_ )
_η_ _p_ +1 _←_ max( _η_ _p_ _/µ_ ¯ _p_ +1 _, η_ _tol_ )
**else:**
_**λ**_ _p_ +1 _←_ _**λ**_ _p_
_**µ**_ _p_ +1 _←_ _τ_ _**µ**_ _p_
_µ_ ¯ _p_ +1 _←_ Average( _**µ**_ _p_ )
_ω_ _p_ +1 _←_ max(1 _/µ_ ¯ _p_ +1 _, ω_ _tol_ )
_η_ _p_ +1 _←_ max(1 _/µ_ ¯ [0] _p_ _[.]_ +1 [1] _[, η]_ _[tol]_ [)]
**end if**



3


_p ←_ _p_ + 1
**end while**


Here _w_ _tol_ is the tolerance of the Lagrangian gradient
and _η_ _tol_ is the tolerance for the measure of constraint violation, and together they set the convergence condition.
The argmin( _L_ _A_ ) optimization is an internal minimization
step where for fixed Lagrange multipliers the local optimizer L-BFGS-B [43] is used, a quasi-Newton method
suitable for problems with a high number of degrees of
freedom. In the context of SIMSOPT the individual gradients of each constraint function _c_ _i_ ( _**x**_ ) are calculated
using a combination of analytic derivatives and automatic differentiation, where the chain rule is applied using vector-Jacobian products allowing for efficient derivative estimations. As mentioned previously, the goal is to
design feasible coils that are able to reproduce exactly the
magnetic field of fusion plasmas. Therefore, the main objective of the optimization is to minimize the field error.
This is achieved via the normalized squared flux, which
is a measure of deviation between the coil magnetic field
and the target magnetic surface,



Here _d_ **l** _i_ is the differential arc-length element of the filament, Γ _i_ is the i-th coil curve and **r** is the distance
between the corresponding arc-length element and the
evaluation point. When _f_ _SF_ = 0, the field produced by
the stellarator coils is exactly tangential to the desired
magnetic plasma surface. If this is achieved, then the
plasma MHD equilibrium is ensured. However, computational methods cannot exactly produce _f_ _SF_ = 0 for
the entire plasma boundary. This necessity for zero errors seems to imply that _f_ _SF_ should serve as a candidate
for the minimization function _f_ in Equation 4.
Instead, in this work, the function _f_ is replaced with
a dummy objective function that returns 0, and the
squared flux function is moved to the constraints with all
the other objectives. This is motivated by the fact that
the augmented Lagrangian methods are highly adapted
to minimize constraint violation. We also found that for
many devices _f_ _SF_ ≲ 10 _[−]_ [6] or so is sufficient for reproducing the plasma properties. In this case, we can convert the squared flux objective to max( _f_ _SF_ _−_ 10 _[−]_ [6] _,_ 0) [2] .
Once this constraint is satisfied, the algorithm is free to
use the extra “slack” to improve engineering constraints,
rather than continuing to focus on the squared flux. This
is also advantageous because it does not make practical sense to exactly fit _f_ SF = 0; there will inevitably
be error fields from a host of real-world sources that



_|_ **B** _·_ **n** _|_ [2]

_dS,_ (5)
_|B|_ [2]



_f_ _SF_ = [1]

2



� _S_



where _S_ is the plasma target surface, _**n**_ is its normal
vector, and _**B**_ is the magnetic field generated by the coils
from the Biot-Savart law,



_d_ **l** _i_ _×_ **r**

_._ (6)
_r_ [3]



**B** = _[µ]_ [0]

4 _π_



_N_
� _I_ _i_


_i_ =1



� Γ _i_


will lead to deviations from the desired magnetic fields.
Some precisely-quasisymmetric stellarator designs, like
the Landreman&Paul QA/QH configurations, have fairly
rapid deterioration of the degree of quasisymmetry as
_f_ SF deviates from zero. Nonetheless, these configurations, which have been optimized only for aspect ratio,
rotational transform, and quasisymmetry, will not have
extremely high degrees of quasisymmetry once they are
turned into reactor-designs. In other words, when finite_β_ effects, ideal MHD stability, turbulence reduction, etc.
are factored into the optimization problem, the degree of
quasisymmetry will decrease and subsequently we expect
the sensitivity with respect to errors in _f_ SF will decrease.
_We believe this capability to impose f_ _SF_ _as an inequality_
_constraint is a substantial advantage of our approach._
Regarding the remaining coil constraints, we use standard metrics for complexity in the literature [44, 45]:



_N_

_g_ _cs_ = �


_i_ =1



� Γ _i_



max(0 _, d_ _[cs]_ 0 _[−∥]_ **[r]** _[i]_ _[−]_ **[s]** _[∥]_ [2] [)] [2] _[ dl]_ _[i]_ _[dS,]_ (7a)

� _S_



_i−_ 1
�

_j_ =1



max(0 _, d_ _[cc]_ 0 _[−∥]_ **[r]** _[i]_ _[−]_ **[r]** _[j]_ _[∥]_ [2] [)] [2] _[ dl]_ _[j]_ _[dl]_ _[i]_ _[,]_

� Γ _j_



_g_ _cc_ =



_N_
�


_i_ =1



� Γ _i_



�



4


they are interlinked. Finally, _g_ _f_ minimizes the pointwise
self and mutual forces that are above some _F_ 0 threshold
representing the tolerances of the superconducting material in the coils. The details for the force estimation
can be found in Hurwitz et al. [49]. It has become an increasing necessity to find configurations minimizing the
coil-to-coil forces because the required coil currents in a
reactor-scale stellarator can reach tens of Mega-Ampere
values [20, 45, 50–52]. For the purpose of this work, the
estimation of the maximum force per HTS turn is done
by dividing the total force value by the number of HTS
turns per coil.
In order to determine the relative HTS material requirements for coil sets with varying number of coils per
half-field period, for all the following results in this work
we assume 200 HTS turns per coil for a reference coilset
(e.g. 800 turns total in a four-coil solution) and recalculate the number of turns assuming fixed total current
per half-field period (e.g. a three coil solution will be
assumed to have 800 _/_ 3 HTS turns in each coil to keep
the total current fixed). This is probably a pessimistic
lower bound on the amount of HTS required for solutions
with fewer coils, but it also helps to mitigate the forces
in these designs.
The interest behind designing stellarators with fewer
coils comes from the increased plasma access that is made
available on the outboard side. Fewer coils means more
space in between coils for placing additional ports for
plasma diagnostics, increasing the heating power, and
the easing remote maintenance of the device. We find in
practice that often the minimum coil-coil and coil-surface
distances are higher, meaning less stringent assembly tolerances and more space for a neutron-absorbing blanket.
However the price is paid on the quality of the magnetic
field and a potentially higher amount of required HTS
material.

Lastly, note that while we have avoided the use of
manually determined _weights_, we do not get rid of appropriate upper and lower _bounds_ on these objectives,
as this is typically critical for avoiding undesirable coil
solutions such as coils which are all topologically interlinked. Furthermore, the objectives all have natural upper and lower bounds ( _d_ _[cs]_ 0 [,] _[ d]_ _[cc]_ 0 [, ...) for feasibility that]
are well-motivated by physical and engineering considerations. A summary of natural upper and lower bounds
for a reactor-scale stellarator, and their motivation, is
provided in Table I.


**III.** **RESULTS**


**A.** **Quasi-axisymmetric stellarator**


The first goal for this paper is to demonstrate a novel
computational framework capable of efficiently reaching,
and in fact improving on previously Pareto-optimal solutions. We first consider quasi-axisymmetric stellarators,
which are thought to combine the benefits of both stel


(7b)


_,_ (7c)



_N_
�
� _i_ =1



�� 2



_g_ _l_ = [1]

2



max

�



�



_L_ _i_ _−L_ 0 _,_ 0

_i_ =1



_N_

_g_ msc = �


_i_ =1



1

2



max( _κ−κ_ 0 _,_ 0) [2] _dl,_ (7d)

� Γ _i_



� Γ _j_



**r** _i_ _−_ **r** _j_
_|_ **r** _i_ _−_ **r** _j_ _|_ [3] [(] _[d]_ **[r]** _[i]_ _[×][d]_ **[r]** _[j]_ [)] ����� _,_ (7e)



_c_ link (Γ _i_ _,_ Γ _j_ )= [1]

4 _π_



�����



� Γ _i_



_g_ _f_ = [1]

2



_N_
�


_i_ =1



max( _|_ _**F**_ _i_ ( _l_ ) _|−F_ 0 _,_ 0) [2] _dℓ_ _._ (7f)
�� �



_g_ _cs_ is a function penalizing the minimum distance between the last closed flux surface of the plasma and the
coils, preventing it from being smaller than _d_ _[cs]_ 0 [.] This
can allow enough space for the positioning of a tritiumbreeding blanket and shielding wall to keep the integrity
of the coils and fusion device that can be damaged by
high energy neutrons. _g_ _cc_ restrains the minimum coil-tocoil distance from being smaller than _d_ _[cc]_ 0 [, accounting for]
finite dimensions of the coils as well as coil assembly and
diagnostics. The length of the coils is set by a quadratic
penalty that penalizes the sum of length of all the coils
if it goes above the threshold _L_ 0 . Longer coils means
more expensive superconducting material is required to
construct them. The cost function _g_ msc calculates the _L_ 2
norm of the curvature of a coil and then penalizes the
local curvature of the coil if it exceeds the threshold _κ_ 0 .
Higher curvature coils tend to be more difficult to manufacture and assemble. In order to prevent configurations
with interlinked coils, which would be very challenging
to build in practice, the Gauss linking number _c_ link is
calculated for each pair and becomes an integer _≥_ 1 if


5














|Objective|Bound|Motivation|
|---|---|---|
|Squared Flux|≲10~~_−_6~~|Sufcient accuracy to preserve important plasma properties.|
|Minimum CS distance|≳1_._3m|Sufcient distance for neutron-absorbing blanket.|
|Minimum CC distance|≳0_._7m|Sufcient distance for avoiding coil intersections and assembly difculties from<br>fnite coil build.|
|Total coil length|≲150_ −_200m<br>|As small as possible to decrease the costs of purchasing superconducting ma-<br>terial. But there must be sufcient coil length for coils to be far enough from<br>the plasma to reduce coil-surface distance and improve squared fux.|
|Max curvature_ κ_|≲1 m~~_−_1~~|Low enough local curvature to simplify geometry and manufacturing costs.|
|Max MSC|≲0_._5m_−_1|Similar to the curvature_ κ_, the average curvature must remain low so that the<br>coils can be manufactured precisely without extensive cost.|
|Coil linking #|0|Interlinking coils could greatly increase the complexity of assembly.|
|Max force|≲0_._5 MN/m|Max forces must stay within the force tolerances of the HTS material, esti-<br>mated for industrial REBCO-based cables [46–48].|


TABLE I. Rough estimates of upper _↑_ and lower _↓_ bounds for engineering metrics of a reactor-scale stellarator design.



larators and tokamaks into one device. This includes the
simplicity of the tokamak coils together with the inherent steady-state operation of stellarators. A QA optimized stellarator is in principle also capable of showing
neo-classical transport levels comparable to axisymmetric devices as mentioned previously. The start-up company Thea Energy is currently pursuing this concept using dipole coils for their prototype reactor EOS, which
will be at first a neutron source [27].
The Landreman&Paul quasi-axisymmetric plasma
equilibrium scaled at 1 m major radius found in [9] was
chosen in order to be able to compare to the dataset
found in [52], and therefore the same optimization setup is used. This is a plasma configuration with 2-field
periods, aspect ratio 6 and rotational transform of 0.42,
exceptional confinement properties with a magnetic field
error comparable to Earth’s magnetic field amplitude.
Kaptanoglu et al [45] performed 8,500 stellarator coil
optimizations with five coils per half-field period (hfp) in
order to find trade-offs between the magnetic field accuracy that can be achieved with the coils and the Lorentz
forces that act on the coils. A similar scan was performed
in Hurwitz et al. [52]. From the 8,500 minimization runs
on a supercomputer, about 41 defined a Pareto front between the coil forces and the field accuracy which is measured using the surface integrated average of the normal
component of the magnetic field to the target surface
normalized by its amplitude: _⟨_ _**B**_ _·_ _**n**_ _⟩/⟨B⟩_ .
In order to filter suitable candidates from the
8,500 configurations, multiple thresholds are applied aposteriori to be able to determine a valid Pareto-front
and remove any undesirable coil solutions that should
not be considered (e.g. interlinked coils). The thresholds include a maximum allowed curvature of 12 m _[−]_ [1],
maximum allowed coil length: 6.5 m, minimum distance
between coils and plasma surface: 16.6 cm, minimum
distance between coils: 8.3 cm. The number of coil optimizations that were performed in the scans is a testament
to the computing power needed in previous methods to
achieve optimal devices.

The initial goal of this work is to be able to map this



existing Pareto front. This is done by running our augmented Lagrangian scheme and adjusting the upper linear force threshold to 9, 10, 10.5 and 12 kN/m. Each run
takes around 40 minutes on a single CPU core, and is
stopped once the algorithm reaches the maximum number of iterations, set to 50 in this case. The quadratic flux
also possesses an upper boundary which is on purpose set
to low values (10 _[−]_ [15] ) to force the optimizer to reach the
lowest error configurations. All four configurations are
plotted on Figure 1 and they all sit at the Pareto front.
These results are calculated with a fixed total length of
25 m; we then try to define a new Pareto front by relaxing
this constraint and setting the total length threshold to
30 m. By running 6 different optimizations with the linear force thresholds set to 14, 12, 11, 10, 9.5 and 9 kN/m,
it is possible to trace-out a new limit visible in Figure 1
with the black stars. This is a similar class of stellarators
as previously, with the main difference that they achieve
up to one order of magnitude better field accuracy reaching a _⟨_ _**B**_ _·_ _**n**_ _⟩/⟨B⟩_ = 1 _._ 97 _×_ 10 _[−]_ [5] at 14 kN/m.


For the purposes of comparison with the Wechsung et
al. [15] solutions in Table II, four-coil configurations are
now scaled to reactor size with 5.7T on-axis magnetic
field strength and 1.7m minor radius, following ARIESCS [53]. The total length upper bounds are set to the
lengths used for the coils sets in Wechsung’s solutions
and our solutions are systematically compared. For instance, the 18m total length coils for a 1m major radius
design are indicated by L18. Scaled to a reactor, the total coil length is 182m with a 10 _._ 13m major radius. As
far as we can tell, the Wechsung solutions are essentially
Pareto-optimal. Nonetheless, _without tuning the weights_,
we can produce a L18 solution that is essentially equivalent to the Wechsung L18 solution; the only significant
difference is that the coil-coil distance and max curvature
are slightly larger in our solution. Similarly our L20 solution is essentially identical, although arguably improved
by reducing the unnecessarily large coil-surface distance
and increasing the minimum coil-coil distance by 0 _._ 17m.
For the L24 solution, we purposely avoid penalizing the
force in order to see that only marginal improvements in


6

|Property|3-coil L18|Wechsung L18|L18|Wechsung L20|L20|Wechsung L24|L24|
|---|---|---|---|---|---|---|---|
|# of coils per hfp_ ↓_<br>_⟨_**_B_**_ ·_**_ n_**_⟩/⟨B⟩×_ 10_−_5 _↓_<br>Max (**_B_**_ ·_**_ n_**_/B_)_ ×_ 10_−_4 _↓_<br>Max Force [MN/m]_ ↓_<br>Total Length [m]_ ↓_<br>Min CC Distance [m]_ ↑_<br>Min CS Distance [m]_ ↑_<br>Max_ κ_ [m_−_1]_ ↓_<br>Max MSC [m_−_1]_ ↓_<br>HTS length [km]_ ↓_|**3**<br>85.5<br>28<br>**0****_._41**<br>**182**<br>**1****_._49**<br>2.74<br>0.53<br>0.05<br>194|4<br>91.1<br>34<br>0_._44<br>**182**<br>1.34<br>2.75<br>**0****_._44**<br>0.05<br>**146**|4<br>93.7<br>34<br>0_._43<br>**182**<br>1_._44<br>2.57<br>0.5<br>0.05<br>**146**|4<br>32<br>13<br>0_._47<br>203<br>1.14<br>2.9<br>0.49<br>0.05<br>162|4<br>34<br>12<br>0_._46<br>203<br>1.31<br>2.71<br>0.51<br>0.05<br>162|4<br>**4****_._35**<br>**1****_._6**<br>0_._55<br>243<br>1_._0<br>3_._1<br>0_._49<br>0.05<br>194|4<br>6.0<br>2.9<br>0_._85<br>240<br>1_._0<br>**3****_._14**<br>0_._5<br>0.05<br>192|



TABLE II. Comparison of magnetic field and coil properties for our solutions and the corresponding Wechsung solutions scaled
to the ARIES-CS [53] reactor with 5.7T on axis and 1.7m minor radius. Properties that should ideally be lowered (increased)
in the design are indicated by _↓_ ( _↑_ ). Here, we assume a fixed total current per half-field period, taking 200 HTS turns per coil
for the 4 coil solution as reference, explaining the difference in the max force between the table values and Figure 2.



FIG. 1. Scans of QA stellarator configurations from [45]
showing trade-offs between coil forces and field accuracy, with
red stars placing the new configurations at the found Paretofront and black ones outlining a new Pareto-front for configurations with larger coil length.


the field accuracy and other metrics are available. At the
same time, the max force increases by almost 50% compared to the Wechsung L24 solution. We show this result
to illustrate the diminishing returns to “over-optimizing”
on the field accuracy.
Lastly, at a given fixed total length, we attempted some
three-coil and five-coil solutions. Five-coil solutions were
found with comparable or marginally improved performance to the four-coil solutions, so we concluded that
the extra coil per half-field period was not worth the
inevitable reduction in plasma access. However, assuming that fairly long modular coils can be constructed in
practice, an excellent solution was found with 182m total length coil solution with only three coils per hfp. It
replicates most of the equivalent (i.e. same total coil



length) four-coil solution complexity metrics while exhibiting better field accuracy and higher coil-coil distances. It can be seen visually in Fig. 2 to provide
very good plasma access. These benefits will have to be
weighed against the additional coil turns in the three-coil
solution that will be necessary to continue avoiding the
critical current limits in the superconducting material.
For completeness, the Boozer plot which displays qualitatively the departure from quasisymmetry together with
the Poincar´e plots showing the nested flux surface structure of the magnetic equilibrium are shown in the Appendix A. Straight lines tell that very low levels of quasisymmetric error are achieved.
Furthermore, the reason why, out of the 8,500 runs performed in previous work only 41 defined a Pareto front,
lies in the fact that the adjustment of the weights but also
the arbitrary truncation of thresholds modify the stellarator optimization landscape in such a way that it prevents convergence towards good configurations. In contrast, our proposed method takes care of the weight adjustment dynamically throughout the optimization, and
informs their update based on the penalty violation of
each of the constraints.


**B.** **Quasi-helical symmetric Stellarator**


In a second optimization demonstration, we target
the plasma boundary of the Landreman&Paul quasihelically symmetric (QH) configuration [9]. Like quasiaxisymmetric plasmas, QH equilibria are designed to confined collisionless trapped particles having also reduce
alpha-particle losses. The QH configuration is also the
only type of quasisymmetry that has been effectively
built with the Helically Symmetric eXperiment (HSX)[6],
which is explored in Section III E. One of the reasons QH
symmetry and more generally quasisymmetric stellarators are of interest for a potential fusion reactor lies in
the prediction of shear flows in the plasma, allowing for
the suppression of microturbulence [54]. However, a fourfield-period QH configuration is considered to be more


7


FIG. 2. (Top, left to right) Three-coil solution, four-coil solution, and four-coil Wechsung solution, all with same total coil
length. (Middle, left to right) Four coil solution with augmented Lagrangian versus the Wechsung solution obtained at same
total coil length. (Bottom, left to right) Same as the middle panel, but with increased total coil length. Forces appear very
large because they are reported here before dividing by the number of turns.



demanding from a coil optimization standpoint since the
plasma contains more shaping than the QA configuration
shown previously. The objective is to reproduce particle confinement properties of this configuration to high
enough accuracy. Therefore, the coils here obtained are
compared and optimized using the same set-up as in [55],
where the main purpose was to obtain a suitable coil
configuration at reactor-scale. The major radius of this
configurations is approximately 13 m, the aspect ratio is
approximately 8 and the average rotational transform is
1.24.


In the original work in Wiedman et al. [55], five coils
per hfp were chosen as it was considered that fewer coils
did not yield high enough accuracy to reproduce the
plasma equilibrium at the coil-to-coil and coil-to-surface
distances required. Here, we show that not only it is
possible to reproduce a similar configuration as in [55],
but it is also possible to reduce the number of coils to
four per half field period. The total coil length is also
reduced by slightly relaxing other physical requirements.
The results for both these optimizations are displayed on



Table III. Together the average field accuracy and maximum field error are comparable to the original work for
both the four coil and five coil configurations, the stellarators are shown in Figure 3. Except for 0 _._ 2m-reduced
minimum coil-coil distance and requiring more HTS material, the four-coil solution is as good, or better, in every
engineering metric as the Wiedman solution.


To further verify that these coils generate magnetic
fields that that fulfill physics requirements, we plot the
Boozer plot of the outmost closed magnetic surface together with the Poincar´e cross-sections of the equilibrium, shown in Appendix A. As expected the magnetic
field amplitude contours appear straight with the lowfield regions displaying higher levels of coil ripple than as
reported by Wiedman et al., however this is consistent
with the fact that the configuration has one less coil per
half-field period than previously. It is also possible to reveal the nested structure of the QH equilibrium without
any apparent magnetic island chains, capturing the high
degree of shaping of the equilibrium.


Confinement of collisionless trapped particles is also


|Property|#1|#2|Wiedman|
|---|---|---|---|
|# of coils per hfp_ ↓_<br>_⟨_**_B_**_ ·_**_ n_**_⟩/⟨B⟩×_ 10_−_4 _↓_<br>Max (**_B_**_ ·_**_ n_**_/B_)_ ×_ 10_−_3 _↓_<br>Max Force [MN/m]_ ↓_<br>Total Length [m]_ ↓_<br>Min CS Distance [m]_ ↑_<br>Min CC Distance [m]_ ↑_<br>Max_ κ_ [m_−_1]_ ↓_<br>Max MSC [m_−_1]_ ↓_<br>Quasisym. Error_ ×_10_−_3 _↓_<br>HTS length [km]_ ↓_|**4**<br>6_._2<br>2_._7<br>**0****_._2**<br>**160** <br>**1.91**<br>0.8<br>1<br>0.1<br>5_._2<br>320|5<br>6_._2<br>**2****_._6**<br>0.36<br>177.8<br> 1.59<br>**1.09**<br>**0.77**<br>0.08<br>2_._3<br>284.5|5<br>**6****_._1**<br>3_._1<br>0.31<br>177.8<br>1.62<br>**1.09**<br>0.81<br>**0.079**<br>**2****_._2**<br>284.5|


FIG. 3. (Top) The stellarator coil configuration for the 4coil case (QH4). (Middle) The stellarator coil configuration
for the 5-coil case (QH5). (Bottom) Original 5 coil per halffield period QH coilset optimized by Wiedman _et al._ [55].
Forces appear very large because they are reported here before
dividing by the number of turns.


strongly suggested by the low quasisymmetric error
present in these configurations. Note that this is achieved
without necessarily breaching the thresholds and activating the constraints in the optimization. In particular, this
is visible in table III for the coil-surface distance (lower
bound set to 1 _._ 5m) and the maximum curvature (upper
bound set to 1m _[−]_ [1] ) for the QH4 and QH5 configurations
respectively. This shows that _it is possible to set loose_
_upper and lower bounds and still obtain feasible solutions_
_that do not necessarily achieve the bounds._ In Section
III E, we present results in the same spirit as for this configuration but for the fully manufactured and assembled
QH HSX stellarator.



8


TABLE III. Comparison of coil properties for the three different QH configurations, assuming 200 turns per coil for the
max force calculations. Properties that should ideally be lowered (increased) in the design are indicated by _↓_ ( _↑_ ).


**C.** **Stellaris: a Stable Quasi-Isodynamic Stellarator**
**(SQUID)**


A third demonstration of the improvement brought
by our method is shown on a Stable Quasi-Isodynamic
Design (SQuID) stellarator configuration [34] that was
recently published by the fusion start-up Proxima Fusion [25] to serve as prototype for a fusion power plant.
The interest behind this class of stellarators lies in
their physics properties and recent optimization reported
in [34], where they appear MHD stable, as a consequence
the maximum- _J_ property described in [56, 57]. This
property is also predicted to mitigate turbulence from
the trapped electron mode (TEM) [3, 58, 59]. The same
class of stellarators is being pursued by other companies
such as Type One Energy [26]. Moreover, SQuIDs display low small collisional thermal transport, bootstrap
current, and fast-ion losses, which can have a great impact on plasma heating, stability and divertor operation [3, 57, 60]. Finally, there is also evidence suggesting that ITG turbulent heat fluxes of SQuIDs are below that of the W7-X stellarator [34]. However, for past
QI configurations it has been challenging to find buildable and accurate coils such as W7-X. On top of that,
fine-tailored fieldline curvature imposing the maximum_J_ property or MHD stability render the task even more
complex. Proxima Fusion published a four field-period
SQuID configuration with major radius 12.7m, minor radius 1.3m, a plasma volume of 425m [3] (about half the
volume of ITER), an axis averaged magnetic strength of
9T, and is supposed to deliver 2700 MW of peak fusion
power. Therefore, the coilset found by Proxima consists
of six coils for half-field period. While this allows for more
field accuracy, it also comes at the cost that by accounting for the finite-dimensions of the winding pack, the
minimum casing-to-casing distance reaches 11.4 mm and
assuming 200 turns per coil, peak HTS turn linear force
on the filamentary coils is of 0.9 MN/m. This value is at
the peak material force tolerances and limits the possibility for structural supports. These very tight engineering


constraints are typical for reactor-scale stellarators.


FIG. 4. (Top) First possible configuration for the Stellaris SQuID with 5 coils per half-field period, same field errors. (Middle) Second possible configuration for the Stellaris
SQuID with similar parameters but forces are reduced by
29%. (Bottom) Proxima’s configuration with 6 coils per hfp,
recently published in [25]. Forces appear very large because
they are reported here before dividing by the number of turns.


Here two alternative configurations are presented, one
with 5 coils and the other with 6 coils per half-field period. In the former case, setting similar thresholds as the
characteristics of Proxima’s coilset except for the intercoil distance, yields a configuration that improves on the
magnetic field error average by 25%, as well as giving an
additional 13 cm of space between coils which allows for
better handling of eventual inaccuracies from manufacturing, assembly, thermal contraction or magnetic forces
which appear 5% larger. The coilset is displayed on Figure 4. The main parameters are summarized on IV. Taking 200 turns per coil in the 6-coil solutions as reference
and fixed total current per half-field period, it is possible
to extrapolate the amount of HTS length required for the
2 solutions. While the two solutions come at a slightly



9


higher cost of HTS tape, these configurations can enable
extra access to the plasma, and facilitate reactor maintenance, which is a cost driver. Moreover, the 6 coil case
improves on both the 5 coil configuration and Proxima’s
coils with a field error that is cut by around half, linear
forces on the HTS turns that are 29% lower, similar distances between coils and between the plasma surface and
the conductor as Proxima. Note that this is however a
conservative estimate of the amount of HTS required as
it assumes that the tape is always operated at the limit
of arbitrarily set engineering requirements for the critical

current.
In order to achieve the reduced force configuration, the
curvature and length curvatures constraints were relaxed,
allowing the total length of the conductors to reach 145
m. The corresponding Boozer plots which serve as a verification for the departure from the target isodynamicity
are shown in Appendix A. As shown in Table IV, the Stel
|Property|#1|#2|Proxima|
|---|---|---|---|
|# of coils per hfp_ ↓_<br>_⟨_**_B_**_ ·_**_ n_**_⟩/⟨B⟩×_ 10_−_3 _↓_<br>Max (**_B_**_ ·_**_ n_**_/B_)_ ×_ 10_−_2 _↓_<br>Max Force [MN/m]_ ↓_<br>Total Length [m]_ ↓_<br>Min CC Distance [m]_ ↑_<br>Min CS Distance [m]_ ↑_<br>Max_ κ_ [m_−_1]_ ↓_<br>Max MSC [m_−_1]_ ↓_<br>HTS Length [km]_ ↓_|**5**<br>3_._0<br>2_._2<br>0_._79 <br>**130**<br>**0.8**<br>**1.38**<br>**1.57**<br>**0.3**<br>250|6<br>**2****_._3**<br>**1****_._6**<br>**0****_._64**<br>145<br>0.7<br>1.3<br>1.6<br>0.35<br>232|6<br>4_._0<br>3_._5<br>0_._9<br>138<br>0.67<br>1.37<br>**1.57**<br>0.34<br>**221**|



TABLE IV. Comparison of magnetic field and coil properties
for the three different Stellaris configurations. #1 and #2
are results from this work, the Proxima configuration was
optimized by the start-up Proxima Fusion. Forces were scaled
by assuming 200 turns per coil in the six-coil solution and
fixed total coil current per half-field period.


laris configuration is improved in essentially all aspects
by the two different coil solutions found here, except potentially for the amount of HTS required. Nonetheless,
final decisions about coil and HTS stack design require
full finite-element modeling of the coils and structural
supports beyond the scope of this work.


**D.** **Wendelstein 7-X (W7-X)**


So far the configurations described correspond to devices that have been conceptualized but not yet built.
In this and the next sections, we show that it is possible to even improve the coil designs of stellarators that
have been fully manufactured and assembled and already
delivered experimental results. The predecessor of Wendelstein 7-X, Wendelstein 7-AS, was the first stellarator
to successfully demonstrate that the two stage approach
to stellarator design, as previously described, is able to
generate a feasible reactor [11]. In order to bring forward the stellarator program the main goals of W7-X
were to demonstrate the generation of nested magnetic


surfaces with modular superconducting coils, enhanced
fast-particle confinement, reduced parallel currents, minimal neoclassical transport at low collisionality, and MHD
stability up to an average plasma beta of 5% [61]. Wendelstein 7-X is currently the largest operating stellarator in the world, being at the forefront of stellarator
research and fusion science generally. The first experimental campaign was performed in 2015, using NbTi superconducting coils to generate a quasi-isodynamic magnetic field with 3T on axis. As mentioned in the introduction, the W7-X manufacturing and assembly process
presented various delays due to tight coil tolerances. In
practice this meant that many of the manufactured coils
were discarded as they did not meet the requirements,
resulting in additional costs.
Three different configurations are presented as options
for W7-X in Figure 5. As is illustrated in Table V, all

|Property|#1|#2|#3|W7-X|
|---|---|---|---|---|
|# of coils per hfp_ ↓_<br>_⟨_**_B_**_ ·_**_ n_**_⟩/⟨B⟩×_ 10_−_3 _↓_<br>Max (**_B_**_ ·_**_ n_**_/B_)_ ×_ 10_−_2 _↓_<br>Max Force [kN/m]_ ↓_<br>Total Length [m]_ ↓_<br>Min CC Distance [m]_ ↑_<br>Min CS Distance [m]_ ↑_<br>Max_ κ_ [m_−_1]_ ↓_<br>Max MSC [m_−_1]_ ↓_<br>HTS Length [km]_ ↓_|**4**<br>10<br>5_._5<br>**15**<br>**38**<br>**0.3** <br>0.32<br>2.51<br>**1.5**<br>95|5<br>6_._7<br>**4****_._1**<br>**15**<br>45<br>0.27<br> 0.3<br>** 2.0**<br>**1.5**<br>90|5<br>**6****_._6**<br>4_._2<br>19<br>43<br> 0.26<br>0.34<br>**2.0**<br>**1.5**<br>86|5<br>29<br>11<br>19<br>42.6<br>0.28<br>** 0.37**<br>2.56<br>1.96<br>**85****_._2**|



TABLE V. Comparison of magnetic field and coil properties
for the four different W7-X configurations. #1, #2 and #3
are results from this work, the W7-X configuration was taken
from the original CAD files and adapted as single filaments for
the W7-X standard configuration (without additional planar
coils). Here the max force and HTS length are computed with
200 HTS turns per coil using the five-coil solution and fixed
total current per half-field period.


the configurations are optimized to possess lower curvatures than the original W7-X coilset. The results are
visible in the coils shown in Figure 5, as all the newly
optimized coils appear smoother and with less local curvature than the W7-X ones. Note that all configurations
possess comparable lengths to the W7-X coils. This freedom is purposely imposed for this study, as the goal is
to explore options to the current W7-X reactor coils and
not to replicate it.
Configuration #1 presents substantial advantages over
the original W7-X coilset; the full reactor requires 40 coils
instead of 50, but still provides better field accuracy, reduced total coil length, increased minimum coil-coil distance, and reduced curvatures. In every metric it is improved over the original design, except for a 5cm reduced
minimum plasma-coil distance. Access to the plasma is
substantially increased, as can be seen visually in Fig. 5.
The reduced number of coils can help to drive costs down
by reducing material, reducing assembly difficulties, and
increasing the amount of plasma access for diagnostics,
which has become a bottleneck in the operation of W7-X.



10


FIG. 5. (#1) First alternative configuration for the W7-X
stellarator with 5 coils per half-field period, improved field errors, simpler coils. (#2) Second alternative coilset for the W7X stellarator with improved field accuracy, 20% less forces,
longer coils, but lower curvature. (#3) Third alternative
coilset for W7-X with improved field error, similar coil length,
same forces and simpler coils. (#4) Original W7-X coilset extracted from the CAD design with 5 coils per half-field period.
Forces appear very large because they are reported here before dividing by the number of turns.


Configuration #2 is targeted to reduce the electromag

netic forces compared to the original design. By allowing
only an increase of 5% of the total coil length, slightly
closer coils to each other and to the plasma, it is possible to achieve a reduction of about 20% of the force
load on the support structure and coils of W7-X. Note
that it has been reported by Pedersen et al. [62] that
the rotational transform profile and island chain structure are modified due to deformations in the coil shapes
resulting from increasing electromagnetic forces. Additionally this new configuration comes with an improvement of about an order of magnitude in field accuracy.
Configuration #3 is also an exciting find. With very tiny
changes of 0 _._ 4m more total coil length, 0 _._ 02m reduction
to minimum coil-coil distance, and 0 _._ 03m reduction to
minimum coil-surface distance, the squared flux and curvatures are dramatically improved, without change to the
max forces.

The degree of omnigeneity for all coil sets displayed
by the magnetic field strength contours is plotted in Appendix A. All W7-X alternatives show contours following
the target field. As shown in Figure 5, the #2 and #3 alternatives possess four visibly simple coils out of five with
only one coil type standing out as longer. It also appears
that lower overall forces can be achieved by relaxing the
length constraint on an individual coil type. To our current knowledge and given the current parameters of the
W7-X coils displayed in Table V, any of these three alternatives of W7-X could be considered as candidates for
a W7-X-style research reactor.


**E.** **Helically Symmetric eXperiment (HSX)**


The Helically Symmetric eXperiment (HSX) is a stellarator located at the University of Wisconsin in Madison. The device began operation in 1999, and was and
still is the only device in the world with a quasi-helical
stellarator field. It is a four field period stellarator with
48 copper coils, around 1T on axis and major radius of
1.4m. HSX was designed to demonstrate reduced direct
orbit losses, Mercier stability, and reduced neoclassical
transport. Due to its rotational transform of 1.05 on
axis and quasi-helical field, its neoclassical confinement
is similar to a _q_ = 1 _/_ 3 tokamak [6]. It has also managed to
demonstrate reduced flow damping and reduced electron
heat transport [63, 64]. Unlike the QH stellarator equilibrium shown in Section III B which was optimized for
low quasisymmetric error throughout the volume, HSX
was only optimized for quasisymmetry on the last closed
flux surface because at the time no robust optimization
methods had been developed yet. Similarly to W7-X,
HSX coils were obtained using a winding surface method,
which yielded six coils per half field period with high
curvatures. From the twisted filaments, a copper winding pack was constructed for the final reactor, these are
shown in Figure 6. The procedure in this section does not
aim at improving the forces, since the force requirements
become much more stringent at reactor-scale. Given the



11


smaller dimensions and relatively low magnetic fields of
this device, we focus instead on finding simpler coils that
are easier to manufacture. We propose three different
configurations with four, five, and six coils per half-field
period, summarized in Table VI. As expected, the average field error progressively increases with decreasing
number of coils. This is consistent with the results from
the previous QH, Stellaris and W7-X configurations.

|Property|#1|#2|#3|HSX|
|---|---|---|---|---|
|# of coils per hfp_ ↓_<br>_⟨_**_B_**_ ·_**_ n_**_⟩/⟨B⟩×_ 10_−_3 _↓_<br>Max (**_B_**_ ·_**_ n_**_/B_)_ ×_ 10_−_2 _↓_<br>Max Force [kN/m]_ ↓_<br>Total Length [m]_ ↓_<br>Min CC Distance [m]_ ↑_<br>Min CS Distance [m]_ ↑_<br>Max_ κ_ [m_−_1]_ ↓_<br>Max MSC [m_−_1]_ ↓_<br>HTS length [km]_ ↓_|**4**<br>11<br>4_._7<br>0.7<br>**10****_._0**<br>**0.10**<br>**0.15**<br>9.7<br>**25**<br>24|5<br>7_._5<br>4_._2<br>0.88<br> 12.1<br>** 0.10**<br> 0.13<br>12<br>30<br>23.2|6<br>**5****_._3**<br>**2****_._2**<br>0.7<br> 13.4<br> 0.09<br> 0.11<br>**8**<br>30.0<br>**21.4**|6<br>5_._8<br>2_._5<br>**0****_._6**<br>13.4<br>0.09<br>0.14<br>12.34<br>45.1<br>** 21.4**|



TABLE VI. Comparison of magnetic field and coil properties
for the four different HSX configurations. #1, #2 and #3 are
results from this work, the HSX configuration was taken from
the original CAD files and adapted as single filaments for the
HSX standard Quasi-Helical Symmetry QHS configuration.
Here the max force is the force on 200 turns of HTS per coil
in the reference six-coil solution.


The three proposed configurations are mostly characterized by their reduction in curvature, which can be understood as a proxy for coil complexity. The reduction
in mean squared curvature reaches 45% in configuration
#1, and absolute normal curvature is decreased by 35%
in configuration #3. Despite configuration #3 exhibiting
the same number of coils per hfp, it manages to improve
on the field accuracy while having simpler coils, the same
clearance inbetween coils, and losing only 3 cm in the coilto-surface distance. The forces are generally increased in
all the optimized configurations, as they are not a target.
It remains the sole aspect where the original HSX design
is better.
Configuration #1 is an exemplary solution. Configuration #1 has reduced by two the number of coils per
half field period. This level of coil reduction has not
been tried in previous sections, as it is often expected
that field accuracy will not be precise enough with so
few coils per hfp. Amazingly, and despite the fewer coils
per hfp, configuration #1 has reasonable field accuracy,
and, compared with the original six-coil design, improved
minimum coil-coil and coil-surface distances, lower curvatures, and achieves all of these improvements with 25%
less total coil length. Despite the factor of two increase in
field error compared to the original design, the magnetic
field contours plotted in 11 still display comparable accuracy to the other candidates. As previously mentioned,
less coils are of particular interest in a research scale reactors where additional diagnostics are usually designed
throughout the operation time and need space for new
ports. The additional space in between coils on the out

FIG. 6. (#1) First alternative configuration for the HSX stellarator with 4 coils per half-field period, simpler coils, improved coil-to-surface and intercoil distance. (#2) Second
alternative coilset for the HSX stellarator with 5 coils per
half-field period and simpler coils. (#3) Third alternative
coilset for HSX with improved field error, similar coil length,
and considerably simpler coils. (#4) Original HSX coil design
with 6 coils per half-field period. Forces appear very large because they are reported here before dividing by the number
of turns.


board side is noticeable on Figure 6. Less coils also means



12


less machining time and workforce required in the case
of HSX as the coils are made out of copper and usually
require the operation of CNC-milling or other heavy machinery devices. This can directly translate to reduced
costs, which is often a limiting factor in university scale
reactors and more generally in any type of reactor.


**IV.** **CONCLUSION**


In this work, we have introduced and validated a novel
optimization methodology that fundamentally advances
the state-of-the-art in stellarator coil design. The challenge of designing magnetic coils for a fusion reactor
has long been characterized by difficult tradeoffs between
achieving the precise magnetic field geometry required for
plasma confinement and satisfying practical engineering
constraints. Existing methods often lead to computationally intensive searches through vast parameter spaces,
with no guarantee of arriving at a viable, let alone optimal, solution. Our approach confronts this challenge,
establishing a robust and computationally efficient pathway for generating coil sets that are not only consistent
with desired plasma equilibria but are also potentially
manufacturable and meet the stringent requirements for
reactor integration. Our methodology was successfully
implemented and tested using the SIMSOPT framework.
By applying an augmented Lagrangian approach to
coil optimization, it was possible to address three critical issues: (1) the automated adjustment of weights
for satisfying the constraints in a non-convex optimization problem, (2) the need for large computational resources and (3) optimally satisfying the tradeoff between
low field errors and engineering constraints. In order to
showcase the high performance of our method, five very
different stellarator equilibria were considered, including
quasi-axisymmetric, quasi-helically symmetric and quasiisodynamic designs. New alternative coil sets were found
for two operating stellarators, Wendelstein 7-X and HSX.
This demonstrates the versatility of this method in order to generate cutting-edge coils independently of the
plasma boundary. The quasi-axisymmetric design illustrated one of the main points of this work: the ability
to perform single-optimization runs that achieve known
Pareto-optimal solutions. By relaxing various constraints
of the coil configurations, we were able to access new
Pareto-boundaries. The automated weight tuning and
reliance on upper and lower bounds allows one to specify loose parameter space bounds, increasing the space of
possible solutions.
All optimizations were performed on an Intel core i712650H laptop on 4 cores for Python multi-threading and
on 1 core for the evaluations of the functions and gradients. Future work includes accelerating the design of stellarator fusion reactors using modular coils, application
to dipole coil arrays, incorporation into single-stage optimization efforts, and further algorithmic improvements.


**ACKNOWLEDGMENTS**


This work was supported through grants from the
Simons Foundation under award 560651 and from the
Helmholtz Association Young Investigators Group program as project VH-NG-1430. We thank Jorrit Lion,
Gabriel Plunk, Alan Goodman, Matt Landreman, and
Benedikt Geiger for sharing plasma boundary configuration files, and Rory Conlin, Paul Huslage, David Bindel


[[1] F. C. Schuller, Disruptions in tokamaks, Plasma Physics](https://doi.org/10.1088/0741-3335/37/11A/009)
[and Controlled Fusion](https://doi.org/10.1088/0741-3335/37/11A/009) **37**, A135 (1995).

[2] G. Jahns, M. Soler, B. Waddell, J. Callen, and H. Hicks,
[Internal disruptions in tokamaks, Nuclear Fusion](https://doi.org/10.1088/0029-5515/18/5/002) **18**, 609
[(1978).](https://doi.org/10.1088/0029-5515/18/5/002)

[3] P. Helander, C. D. Beidler, T. M. Bird, M. Drevlak,
Y. Feng, R. Hatzky, F. Jenko, R. Kleiber, J. H. E. Proll,
Y. Turkin, and P. Xanthopoulos, Stellarator and tokamak
[plasmas: a comparison, Plasma Physics and Controlled](https://doi.org/10.1088/0741-3335/54/12/124009)
Fusion **54** [, 124009 (2012).](https://doi.org/10.1088/0741-3335/54/12/124009)

[4] G. Grieger, W. Lotz, P. Merkel, J. N¨uhrenberg,
J. Sapper, E. Strumberger, H. Wobig, R. Burhenn,
V. Erckmann, U. Gasparino, L. Giannone, H. J.
Hartfuss, R. Jaenicke, G. K¨uhner, H. Ringler,
A. Weller, F. Wagner, the W7-X Team, and
the W7-AS Team, Physics optimization of stellarators, Physics of Fluids [B:](https://doi.org/10.1063/1.860481) Plasma Physics **4**,
2081 (1992), [https://pubs.aip.org/aip/pfb/article-](https://arxiv.org/abs/https://pubs.aip.org/aip/pfb/article-pdf/4/7/2081/12264911/2081_1_online.pdf)
[pdf/4/7/2081/12264911/2081](https://arxiv.org/abs/https://pubs.aip.org/aip/pfb/article-pdf/4/7/2081/12264911/2081_1_online.pdf) ~~1 o~~ nline.pdf.

[5] T. Klinger, C. Baylard, C. Beidler, J. Boscary, H. Bosch,
A. Dinklage, D. Hartmann, P. Helander, H. Maßberg,
A. Peacock, T. Pedersen, T. Rummel, F. Schauer, L. Wegener, and R. Wolf, Towards assembly completion and
preparation of experimental campaigns of Wendelstein
7-X in the perspective of a path to a stellarator fu[sion power plant, Fusion Engineering and Design](https://doi.org/https://doi.org/10.1016/j.fusengdes.2013.02.153) **88**, 461
[(2013), proceedings of the 27th Symposium On Fusion](https://doi.org/https://doi.org/10.1016/j.fusengdes.2013.02.153)
Technology (SOFT-27); Li`ege, Belgium, September 2428, 2012.

[6] F. Anderson, A. Almagri, D. Anderson, P. Matthews,
J. Talmadge, and J. Shohet, Helically symmetric experiment, (hsx) goals, design and status, Fusion Technology
**27**, p. 273–277. (1995).

[7] S. P. Hirshman and J. C. Whitson, Steepestdescent moment method for three-dimensional mag[netohydrodynamic equilibria, The Physics of Fluids](https://doi.org/10.1063/1.864116)
**26** [, 3553 (1983), https://pubs.aip.org/aip/pfl/article-](https://doi.org/10.1063/1.864116)
[pdf/26/12/3553/12590952/3553](https://arxiv.org/abs/https://pubs.aip.org/aip/pfl/article-pdf/26/12/3553/12590952/3553_1_online.pdf) ~~1 o~~ nline.pdf.

[8] J. N¨uhrenberg and R. Zille, Quasi-helically symmetric
[toroidal stellarators, Physics Letters A](https://doi.org/https://doi.org/10.1016/0375-9601(88)90080-1) **129**, 113 (1988).

[9] M. Landreman and E. Paul, Magnetic fields with precise
[quasisymmetry for plasma confinement, Phys. Rev. Lett.](https://doi.org/10.1103/PhysRevLett.128.035001)
**128** [, 035001 (2022).](https://doi.org/10.1103/PhysRevLett.128.035001)

[10] D. W. Dudt and E. Kolemen, Desc: A stellarator equilibrium solver, Physics of Plasmas **27**,
[102513](https://doi.org/10.1063/5.0020743) (2020), [https://pubs.aip.org/aip/pop/article-](https://arxiv.org/abs/https://pubs.aip.org/aip/pop/article-pdf/doi/10.1063/5.0020743/15926767/102513_1_online.pdf)



13


and Tom Simpson for useful discussions.


**Appendix A: Equilibria verification**


This section prevents post-processing illustrations
demonstrating that the physics properties of the plasma
are well-conserved for the coil solutions identified in this
work. Fig. 7 illustrates Boozer and Poincar´e plots for
a Landreman&Paul QA coil solution, and similarly for
Landreman&Paul QH in Fig. 8, Stellaris in Fig. 9, W7-X
in Fig. 10, and HSX in Fig. 11.


[pdf/doi/10.1063/5.0020743/15926767/102513](https://arxiv.org/abs/https://pubs.aip.org/aip/pop/article-pdf/doi/10.1063/5.0020743/15926767/102513_1_online.pdf) ~~1 o~~ nline.pdf.

[11] L.-M. Imbert-G´erard, E. J. Paul, and A. M. Wright,

_[An Introduction to Stellarators: From Magnetic Fields](https://doi.org/10.1137/1.9781611978223)_
_[to Symmetries and Optimization](https://doi.org/10.1137/1.9781611978223)_ (Society for Industrial and Applied Mathematics, Philadelphia, PA, 2024)
[https://epubs.siam.org/doi/pdf/10.1137/1.9781611978223.](https://arxiv.org/abs/https://epubs.siam.org/doi/pdf/10.1137/1.9781611978223)

[12] V. Erckmann, H.-J. Hartfuss, M. Kick, H. Renner,
J. Sapper, F. Schauer, E. Speth, F. Wesner, F. Wagner, M. Wanner, A. Weller, and H. Wobig, The w7x project: scientific basis and technical realization, in
_[17th IEEE/NPSS Symposium Fusion Engineering (Cat.](https://doi.org/10.1109/FUSION.1997.685662)_
_[No.97CH36131)](https://doi.org/10.1109/FUSION.1997.685662)_, Vol. 1 (1997) pp. 40–48 vol.1.

[13] R. Strykowsky, T. Brown, J. Chrzanowski, M. Cole,
P. Heitzenroeder, G. Neilson, D. Rej, and M. Viol, Engineering cost & schedule lessons learned on ncsx, in
_[2009 23rd IEEE/NPSS Symposium on Fusion Engineer-](https://doi.org/10.1109/FUSION.2009.5226449)_
_ing_ (2009) pp. 1–4.

[14] H.-S. Bosch, R. Brakel, T. Braeuer, V. Bykov, P. van
Eeten, J.-H. Feist, F. F¨ullenbach, M. Gasparotto,
H. Grote, T. Klinger, H. Laqua, M. Nagel, D. Naujoks,
M. Otte, K. Risse, T. Rummel, J. Schacht, A. Spring,
T. Sunn Pedersen, R. Vilbrandt, L. Wegener, A. Werner,
R. Wolf, J. Baldzuhn, C. Biedermann, H. Braune,
R. Burhenn, M. Hirsch, U. H¨ofel, J. Knauer, P. Kornejew, S. Marsen, T. Stange, H. Trimino Mora, and W.X. Team, Final integration, commissioning and start of
[the Wendelstein 7-X stellarator operation, Nuclear Fu-](https://doi.org/10.1088/1741-4326/aa7cbb)
sion **57** [, 116015 (2017).](https://doi.org/10.1088/1741-4326/aa7cbb)

[15] F. Wechsung, A. Giuliani, M. Landreman, A. Cerfon,
and G. Stadler, Single-stage gradient-based stellarator
[coil design: stochastic optimization, Nuclear Fusion](https://doi.org/10.1088/1741-4326/ac45f3) **62**,
[076034 (2022).](https://doi.org/10.1088/1741-4326/ac45f3)

[16] A. Giuliani, Direct stellarator coil design using global optimization: application to a comprehensive exploration of
[quasi-axisymmetric devices, Journal of Plasma Physics](https://doi.org/10.1017/S0022377824000412)
**90** [, 905900303 (2024).](https://doi.org/10.1017/S0022377824000412)

[17] R. Wu, T. Kruger, and C. Swanson, Planar coil optimization for the Eos stellarator using sparse regression,
[Plasma Physics and Controlled Fusion](https://doi.org/10.1088/1361-6587/adb5b7) **67**, 035019 (2025).

[18] R. Jorge, A. Giuliani, and J. Loizu, Simplified and flexible coils for stellarators using single-stage optimization,
[Physics of Plasmas](https://doi.org/10.1063/5.0226688) **31**, 112501 (2024).

[19] Y. Suzuki, J. Huang, N. Wang, and Y. Ding, Design of
[simple stellarator using tilted toroidal field coils, Fusion](https://doi.org/https://doi.org/10.1016/j.fusengdes.2021.112843)
[Engineering and Design](https://doi.org/https://doi.org/10.1016/j.fusengdes.2021.112843) **173**, 112843 (2021).


14


FIG. 7. (Left) Boozer plot of the AL25 configuration showing the quality of the quasi-symmetry of the last closed flux surface,
which delimitates the plasma boundary. Perfectly straight lines mean that a very precise level of quasisymmetry is achieved.
(Right) Poincar´e plot showing a cross-section of the plasma where multiple nested flux surfaces are visible with no island chains.


FIG. 8. (Top Left) Boozer plot for configuration #1 showing the quality of the quasi-helical symmetry of the last closed flux
surface. Perfectly straight lines mean that a very precise level of quasisymmetry is achieved. (Top Right) Poincar´e plot of
configuration #1 showing a cross-section of the plasma where multiple nested flux surfaces are visible with no island chains and
rotational transform profile of the configuration which matches the ideal profile.(Bottom Left) Rotational transform profile of
configuration #1. (Bottom Right) QS profiles for the configurations #1, #2, Wiedman, and the original QH target plasma.


15


FIG. 9. (Top Left) Boozer plot of the #2 Stellaris configuration showing the quality of the quasi-isodynamic field generated
by the coils (Top Right) Boozer plot of the target isodynamic-field of Stellaris. The coils appear to accurately capture the
desired features of the boundary magnetic surface.(Bottom Left) Rotational transform profile of the #2 Stellaris configuration.
(Bottom Right) Poincar´e plots of the #2 configuration.




[20] L. Fu, E. J. Paul, A. A. Kaptanoglu, and A. Bhattacharjee, Global stellarator coil optimization with quadratic
[constraints and objectives, Nuclear Fusion](https://doi.org/10.1088/1741-4326/ada810) **65**, 026045
[(2025).](https://doi.org/10.1088/1741-4326/ada810)

[21] M. Drevlak, Optimization of heterogenous magnet sys[tems, 12th International Stellarator Workshop, Madison,](http://www-fusion.ciemat.es/SW2005/conferences/madison99/Papers/Drevlak.pdf)
[WI (1999).](http://www-fusion.ciemat.es/SW2005/conferences/madison99/Papers/Drevlak.pdf)

[22] N. Pomphrey, L. Berry, A. Boozer, A. Brooks,
R. Hatcher, S. Hirshman, L.-P. Ku, W. Miner, H. Mynick, W. Reiersen, D. Strickler, and P. Valanju, Innova[tions in compact stellarator coil design, Nuclear Fusion](https://doi.org/10.1088/0029-5515/41/3/312)
**41** [, 339 (2001).](https://doi.org/10.1088/0029-5515/41/3/312)

[23] D. J. Strickler, L. A. Berry, and S. P. H. and, Designing
[coils for compact stellarators, Fusion Science and Tech-](https://doi.org/10.13182/FST02-A206)
nology **[41](https://doi.org/10.13182/FST02-A206)** [, 107 (2002), https://doi.org/10.13182/FST02-](https://arxiv.org/abs/https://doi.org/10.13182/FST02-A206)
[A206.](https://arxiv.org/abs/https://doi.org/10.13182/FST02-A206)

[24] T. Brown, J. Breslau, D. Gates, N. Pomphrey, and
A. Zolfaghari, Engineering optimization of stellarator
coils lead to improvements in device maintenance, in _[2015](https://doi.org/10.1109/SOFE.2015.7482426)_
_[IEEE 26th Symposium on Fusion Engineering (SOFE)](https://doi.org/10.1109/SOFE.2015.7482426)_
(2015) pp. 1–6.




[25] J. Lion, J.-C. Angl`es, L. Bonauer, A. Ba˜n´on Navarro,
S. Cadena Ceron, R. Davies, M. Drevlak, N. Foppiani, J. Geiger, A. Goodman, W. Guo, E. Guiraud,
F. Hern´andez, S. Henneberg, R. Herrero, C. Hintze,
H. H¨ochter, J. Jelonnek, F. Jenko, R. Jorge, M. Kaiser,
M. Kubie, E. Lascas Neto, H. Laqua, M. Leoni,
J. Lobsien, V. Maurin, A. Merlo, D. Middleton-Gear,
M. Pascu, G. Plunk, N. Riva, M. Savtchouk, F. Sciortino,
J. Schilling, J. Shimwell, A. Di Siena, R. Slade, T. Stange,
T. Todd, L. Wegener, F. Wilms, P. Xanthopoulos, and
M. Zheng, Stellaris: A high-field quasi-isodynamic stel[larator for a prototypical fusion power plant, Fusion En-](https://doi.org/https://doi.org/10.1016/j.fusengdes.2025.114868)
[gineering and Design](https://doi.org/https://doi.org/10.1016/j.fusengdes.2025.114868) **214**, 114868 (2025).

[26] D. T. Anderson, J. M. Canik, C. C. Hegna, and C. M.
Mowry, A comprehensive, unified baseline physics design
for the type one energy stellarator fusion pilot power
[plant, ‘Infinity Two’, Journal of Plasma Physics](https://doi.org/10.1017/S0022377825000297) **91**, e65
[(2025).](https://doi.org/10.1017/S0022377825000297)

[27] D. Gates, S. Aslam, B. Berzin, P. Bonofiglo, A. Cote,
D. Dudt, E. Flom, D. Fort, A. Koen, T. Kruger, S. Kumar, M. Martin, A. Ottaviano, S. Pasmann, P. Romano,
C. Swanson, L. Tang, E. Winkler, and R. Wu, Stellarator


16


FIG. 10. Boozer plots of the four W7-X configurations presented in this work showing the quality of the omnigenous field
generated by the coils: four coils per half field period (#1 Top Left), five coils per hfp with 45 m coil length and reduced forces
(#2 Top Right), five coils per hfp with 43 m coil length and best field accuracy (#3 Bottom Left) and the target W7-X field
in fixed-boundary (Bottom Right).


[fusion systems enabled by arrays of planar coils, Nuclear](https://doi.org/10.1088/1741-4326/ada56c) [056103](https://doi.org/10.1063/1.3693187) (2012), [https://pubs.aip.org/aip/pop/article-](https://arxiv.org/abs/https://pubs.aip.org/aip/pop/article-pdf/doi/10.1063/1.3693187/13988448/056103_1_online.pdf)
Fusion **65** [, 026052 (2025).](https://doi.org/10.1088/1741-4326/ada56c) [pdf/doi/10.1063/1.3693187/13988448/056103](https://arxiv.org/abs/https://pubs.aip.org/aip/pop/article-pdf/doi/10.1063/1.3693187/13988448/056103_1_online.pdf) ~~1 o~~ nline.pdf.

[28] F. Volpe, Renaissance Fusion Technologies, `[https://](https://renfusion.eu/technology)` [34] A. G. Goodman, P. Xanthopoulos, G. G. Plunk,
`[renfusion.eu/technology](https://renfusion.eu/technology)` (2023), accessed: 1 October H. Smith, C. N¨uhrenberg, C. D. Beidler, S. A. Hen2023. neberg, G. Roberg-Clark, M. Drevlak, and P. Helander,

[29] J. Miyazawa and T. Goto, Development of steady-state Quasi-isodynamic stellarators with low turbulence as fu[fusion reactor by Helical Fusion, Physics of Plasmas](https://doi.org/10.1063/5.0145222) sion reactor candidates, PRX Energy **3** [, 023010 (2024).](https://doi.org/10.1103/PRXEnergy.3.023010)
**30** [, 050601 (2023), https://pubs.aip.org/aip/pop/article-](https://doi.org/10.1063/5.0145222) [35] R. Nies, E. J. Paul, D. Panici, S. R. Hudson, and A. Bhat[pdf/doi/10.1063/5.0145222/19997113/050601](https://arxiv.org/abs/https://pubs.aip.org/aip/pop/article-pdf/doi/10.1063/5.0145222/19997113/050601_1_5.0145222.pdf) ~~1 5~~ .0145222.pdf. tacharjee, Exploration of the parameter space of qua
[30] A. Goodman, K. Camacho Mata, S. Henneberg, R. Jorge, sisymmetric stellarator vacuum fields through adjoint
M. Landreman, G. Plunk, H. Smith, R. Mackenbach, [optimisation, Journal of Plasma Physics](https://doi.org/10.1017/S002237782400093X) **90**, 905900620
C. Beidler, and P. Helander, Constructing precisely [(2024).](https://doi.org/10.1017/S002237782400093X)
[quasi-isodynamic magnetic fields, Journal of Plasma](https://doi.org/10.1017/S002237782300065X) [36] M. Landreman, Mapping the space of quasisymmetric
Physics **89** [, 905890504 (2023).](https://doi.org/10.1017/S002237782300065X) [stellarators using optimized near-axis expansion, Journal](https://doi.org/10.1017/S0022377822001258)

[31] D. W. Dudt, A. G. Goodman, R. Conlin, D. Panici, and [of Plasma Physics](https://doi.org/10.1017/S0022377822001258) **88**, 905880616 (2022).
E. Kolemen, Magnetic fields with general omnigenity, [37] M. Landreman, B. Medasani, F. Wechsung, A. Giuliani,
[Journal of Plasma Physics](https://doi.org/10.1017/S0022377824000151) **90**, 905900120 (2024). R. Jorge, and C. Zhu, SIMSOPT: A flexible framework

[32] J. L. Velasco, I. Calvo, F. J. Escoto, E. S´anchez, for stellarator optimization, Journal of Open Source SoftH. Thienpondt, and F. I. Parra, Piecewise omnigenous ware **6**, 3525 (2021).
stellarators, Phys. Rev. Lett. **[133](https://doi.org/10.1103/PhysRevLett.133.185101)**, 185101 (2024). [38] P. Merkel, Solution of stellarator boundary value prob
[33] M. Landreman and P. J. Catto, Omnigenity as [lems with external currents, Nuclear Fusion](https://doi.org/10.1088/0029-5515/27/5/018) **27**, 867
generalized quasisymmetry, Physics of [Plasmas](https://doi.org/10.1063/1.3693187) **19**, [(1987).](https://doi.org/10.1088/0029-5515/27/5/018)


17


FIG. 11. Boozer plots of the four HSX configurations presented in this work showing the quality of the quasi-helically symmetric
field generated by the coils: four coils per half field period (#1 Top Left), five coils per hfp (#2 Top Right), six coils per hfp
(#3 Bottom Left) and the original HSX coil set (Bottom Right).




[39] M. Landreman, An improved current potential method
[for fast computation of stellarator coil shapes, Nuclear](https://doi.org/10.1088/1741-4326/aa57d4)
Fusion **57** [, 046003 (2017).](https://doi.org/10.1088/1741-4326/aa57d4)

[40] R. Conlin, P. Kim, D. W. Dudt, D. Panici, and E. Kole[men, Stellarator optimization with constraints, Journal](https://doi.org/10.1017/S0022377824000655)
[of Plasma Physics](https://doi.org/10.1017/S0022377824000655) **90**, 905900501 (2024).

[41] A. R. Conn, N. I. M. Gould, and P. L. Toint, _Trust-Region_
_Methods_, MPS/SIAM Series on Optimization (Society for
Industrial and Applied Mathematics (SIAM), Philadelphia, PA, 2000).

[42] J. Nocedal and S. J. Wright, _Numerical Optimization_,
2nd ed. (Springer Science & Business Media, 2006).

[43] D. C. Liu and J. Nocedal, On the limited memory BFGS
method for large scale optimization, Mathematical programming **45**, 503 (1989).

[44] C. Zhu, S. R. Hudson, Y. Song, and Y. Wan, New method
to design stellarator coils without the winding surface,
Nuclear Fusion **58**, 016008 (2017).

[45] A. A. Kaptanoglu, A. Wiedman, J. Halpern, S. Hurwitz,
E. J. Paul, and M. Landreman, Reactor-scale stellarators
[with force and torque minimized dipole coils, Nuclear](https://doi.org/10.1088/1741-4326/adc318)
Fusion **65** [, 046029 (2025).](https://doi.org/10.1088/1741-4326/adc318)




[46] Z. S. Hartwig, R. F. Vieira, B. N. Sorbom, R. A. Badcock, M. Bajko, W. K. Beck, B. Castaldo, C. L. Craighill,
M. Davies, J. Estrada, _et al._, VIPER: an industrially scalable high-current high-temperature superconductor cable, Superconductor Science and Technology **33**, 11LT01
(2020).

[47] Z. Zhao, P. Moore, and L. Chiesa, Structural modeling of
REBCO VIPER cable for high-field magnet applications,
IEEE Transactions on Applied Superconductivity **32**, 1
(2022).

[48] N. Riva, R. Granetz, R. Vieira, A. Hubbard, A. Pfeiffer,
P. Harris, C. Chamberlain, Z. Hartwig, A. Watterson,
D. Anderson, _et al._, Development of the first non-planar
REBCO stellarator coil using VIPER cable, Superconductor Science and Technology **36**, 105001 (2023).

[49] S. Hurwitz, M. Landreman, and T. M. Antonsen, Efficient calculation of the self-magnetic field, self-force, and
[self-inductance for electromagnetic coils, IEEE Transac-](https://doi.org/10.1109/TMAG.2024.3455946)
[tions on Magnetics](https://doi.org/10.1109/TMAG.2024.3455946) **60**, 1 (2024).

[50] R. Robin and F. A. Volpe, Minimization of magnetic
[forces on stellarator coils, Nuclear Fusion](https://doi.org/10.1088/1741-4326/ac7658) **62**, 086041
[(2022).](https://doi.org/10.1088/1741-4326/ac7658)


[51] S. Guinchard, S. R. Hudson, and E. J. Paul, Including the
[vacuum energy in stellarator coil design, Plasma Physics](https://doi.org/10.1088/1361-6587/adb789)
[and Controlled Fusion](https://doi.org/10.1088/1361-6587/adb789) **67**, 035028 (2025).

[52] S. Hurwitz, M. Landreman, P. Huslage, and A. Kaptanoglu, Electromagnetic coil optimization for reduced
Lorentz forces, Nuclear Fusion **[65](https://doi.org/10.1088/1741-4326/adc9bf)**, 056044 (2025).

[53] F. Najmabadi, A. R. Raffray, S. I. Abdel-Khalik,
L. Bromberg, L. Crosatti, L. El-Guebaly, P. R. Garabedian, A. A. Grossman, D. Henderson, A. Ibrahim, T. Ihli,
T. B. Kaiser, B. Kiedrowski, L. P. Ku, J. F. Lyon,
R. Maingi, S. Malang, C. Martin, T. K. Mau, B. Merrill,
R. L. Moore, R. J. P. Jr., D. A. Petti, D. L. Sadowski,
M. Sawan, J. H. Schultz, R. Slaybaugh, K. T. Slattery,
G. Sviatoslavsky, A. Turnbull, L. M. Waganer, X. R.
Wang, J. B. Weathers, P. Wilson, J. C. W. III, M. Yoda,
and M. Zarnstorff, The ARIES-CS Compact Stellarator
Fusion Power Plant, Fusion Science and Technology **54**,
655 (2008).

[54] D. Spong, J. Harris, A. Ware, S. Hirshman, and L. Berry,
Shear flow generation in stellarators—configurational
variations, Nuclear Fusion **[47](https://doi.org/10.1088/0029-5515/47/7/013)**, 626 (2007).

[55] A. Wiedman, S. Buller, and M. Landreman, Coil optimization for quasi-helically symmetric stellarator con[figurations, Journal of Plasma Physics](https://doi.org/10.1017/S0022377824000540) **90**, 905900307
[(2024).](https://doi.org/10.1017/S0022377824000540)

[56] P. Helander and J. N¨uhrenberg, Bootstrap current and
neoclassical transport in quasi-isodynamic stellarators,
[Plasma Physics and Controlled Fusion](https://doi.org/10.1088/0741-3335/51/5/055004) **51**, 055004 (2009).

[57] P. Helander, Theory of plasma confinement in non[axisymmetric magnetic fields, Reports on Progress in](https://doi.org/10.1088/0034-4885/77/8/087001)
Physics **77** [, 087001 (2014).](https://doi.org/10.1088/0034-4885/77/8/087001)

[58] H. E. Mynick, N. Pomphrey, and P. Xanthopoulos, Op[timizing stellarators for turbulent transport, Phys. Rev.](https://doi.org/10.1103/PhysRevLett.105.095004)



18


Lett. **105** [, 095004 (2010).](https://doi.org/10.1103/PhysRevLett.105.095004)

[59] J. Proll, G. Plunk, B. Faber, T. G¨orler, P. Helander,
I. McKinney, M. Pueschel, H. Smith, and P. Xanthopoulos, Turbulence mitigation in maximum-J stellarators
[with electron-density gradient, Journal of Plasma Physics](https://doi.org/10.1017/S002237782200006X)
**88** [, 905880112 (2022).](https://doi.org/10.1017/S002237782200006X)

[60] Helander, P. and Geiger, J. and Maaßberg, H., On the
[bootstrap current in stellarators and tokamaks, Physics](https://doi.org/10.1063/1.3633940)
of Plasmas **[18](https://doi.org/10.1063/1.3633940)**, 092505 (2011).

[61] C. Beidler, G. Grieger, F. Herrnegger, E. Harmeyer,
J. Kisslinger, W. Lotz, H. Maassberg, P. Merkel,
J. Nuhrenberg, F. Rau, _et al._, Physics and engineering
[design for Wendelstein VII-X, Fusion Technology; (USA)](https://www.osti.gov/biblio/6681296)
**[17:1](https://www.osti.gov/biblio/6681296)** (1990).

[62] T. S. Pedersen, M. Otte, S. Lazerson, _et al._, Confirmation
of the topology of the Wendelstein 7-X magnetic field to
[better than 1:100,000, Nature Communications](https://doi.org/10.1038/ncomms13493) **7**, 13493
[(2016).](https://doi.org/10.1038/ncomms13493)

[63] S. P. Gerhardt, J. N. Talmadge, J. M. Canik,
and D. T. Anderson, Measurements and modeling of plasma flow damping in the Helically
Symmetric eXperiment, Physics of Plasmas **12**,
[056116](https://doi.org/10.1063/1.1876293) (2005), [https://pubs.aip.org/aip/pop/article-](https://arxiv.org/abs/https://pubs.aip.org/aip/pop/article-pdf/doi/10.1063/1.1876293/13509317/056116_1_online.pdf)
[pdf/doi/10.1063/1.1876293/13509317/056116](https://arxiv.org/abs/https://pubs.aip.org/aip/pop/article-pdf/doi/10.1063/1.1876293/13509317/056116_1_online.pdf) ~~1 o~~ nline.pdf.

[64] J. M. Canik, D. T. Anderson, F. S. B. Anderson,
C. Clark, K. M. Likin, J. N. Talmadge, and K. Zhai, Reduced particle and heat transport with quasisymmetry in
[the Helically Symmetric Experiment, Physics of Plasmas](https://doi.org/10.1063/1.2709862)
**14** [, 056107 (2007), https://pubs.aip.org/aip/pop/article-](https://doi.org/10.1063/1.2709862)
[pdf/doi/10.1063/1.2709862/13887817/056107](https://arxiv.org/abs/https://pubs.aip.org/aip/pop/article-pdf/doi/10.1063/1.2709862/13887817/056107_1_online.pdf) ~~1 o~~ nline.pdf.


